<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Qt项目：自制Wireshark | CentLabs</title><meta name="keywords" content="QT"><meta name="author" content="Cappuccino"><meta name="copyright" content="Cappuccino"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="项目源码1、shark.pro 12345678910111213141516171819202122232425262728293031323334353637383940414243444546QT       +&#x3D; core guigreaterThan(QT_MAJOR_VERSION, 4): QT +&#x3D; widgetsCONFIG +&#x3D; c++11# The following def">
<meta property="og:type" content="article">
<meta property="og:title" content="Qt项目：自制Wireshark">
<meta property="og:url" content="https://centlabs.github.io/2022/08/09/Qt%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%87%AA%E5%88%B6Wireshark/index.html">
<meta property="og:site_name" content="CentLabs">
<meta property="og:description" content="项目源码1、shark.pro 12345678910111213141516171819202122232425262728293031323334353637383940414243444546QT       +&#x3D; core guigreaterThan(QT_MAJOR_VERSION, 4): QT +&#x3D; widgetsCONFIG +&#x3D; c++11# The following def">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-08-09T15:22:32.533Z">
<meta property="article:modified_time" content="2022-08-09T15:27:08.752Z">
<meta property="article:author" content="Cappuccino">
<meta property="article:tag" content="QT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://centlabs.github.io/2022/08/09/Qt%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%87%AA%E5%88%B6Wireshark/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Qt项目：自制Wireshark',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-09 23:27:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">CentLabs</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Qt项目：自制Wireshark</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-08-09T15:22:32.533Z" title="Created 2022-08-09 23:22:32">2022-08-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-08-09T15:27:08.752Z" title="Updated 2022-08-09 23:27:08">2022-08-09</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Qt项目：自制Wireshark"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="项目源码"><a href="#项目源码" class="headerlink" title="项目源码"></a>项目源码</h3><p>1、shark.pro</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">QT       += core gui</span><br><span class="line"></span><br><span class="line"><span class="built_in">greaterThan</span>(QT_MAJOR_VERSION, <span class="number">4</span>): QT += widgets</span><br><span class="line"></span><br><span class="line">CONFIG += c++<span class="number">11</span></span><br><span class="line"></span><br><span class="line"># The following define makes your compiler emit warnings <span class="keyword">if</span> you use</span><br><span class="line"><span class="meta"># any Qt feature that has been marked deprecated (the exact warnings</span></span><br><span class="line"><span class="meta"># depend on your compiler). Please consult the documentation of the</span></span><br><span class="line"><span class="meta"># deprecated API in order to know how to port your code away from it.</span></span><br><span class="line">DEFINES += QT_DEPRECATED_WARNINGS</span><br><span class="line"></span><br><span class="line"># You can also make your code fail to compile <span class="keyword">if</span> it uses deprecated APIs.</span><br><span class="line"># In order to <span class="keyword">do</span> so, uncomment the following line.</span><br><span class="line"># You can also select to disable deprecated APIs only up to a certain version of Qt.</span><br><span class="line">#DEFINES += QT_DISABLE_DEPRECATED_BEFORE=<span class="number">0x060000</span>    <span class="meta"># disables all the APIs deprecated before Qt 6.0.0</span></span><br><span class="line"></span><br><span class="line">SOURCES += \</span><br><span class="line">    capture.cpp \</span><br><span class="line">    datapackage.cpp \</span><br><span class="line">    main.cpp \</span><br><span class="line">    mainwindow.cpp \</span><br><span class="line">    readonlydelegate.cpp</span><br><span class="line"></span><br><span class="line">HEADERS += \</span><br><span class="line">    Format.h \</span><br><span class="line">    capture.h \</span><br><span class="line">    datapackage.h \</span><br><span class="line">    mainwindow.h \</span><br><span class="line">    readonlydelegate.h</span><br><span class="line"></span><br><span class="line">FORMS += \</span><br><span class="line">    mainwindow.ui</span><br><span class="line"></span><br><span class="line">INCLUDEPATH += E:/QT/Code/QtPro/GitPro/Program/Network-capture/Network-capture/Include</span><br><span class="line"></span><br><span class="line">LIBS += E:/QT/Code/QtPro/GitPro/Program/Network-capture/Network-capture/Lib/x64/wpcap.lib  #libws2_32</span><br><span class="line">LIBS += E:/QT/Code/QtPro/GitPro/Program/Network-capture/Network-capture/Lib/x64/Packet.lib</span><br><span class="line"></span><br><span class="line"># Default rules <span class="keyword">for</span> deployment.</span><br><span class="line">qnx: target.path = /tmp/$$&#123;TARGET&#125;/bin</span><br><span class="line"><span class="keyword">else</span>: unix:!android: target.path = /opt/$$&#123;TARGET&#125;/bin</span><br><span class="line">!<span class="built_in">isEmpty</span>(target.path): INSTALLS += target</span><br><span class="line"></span><br><span class="line">RESOURCES += \</span><br><span class="line">    src.qrc</span><br></pre></td></tr></table></figure>

<p>2、capture.h</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> CAPTURE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CAPTURE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QThread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Format.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QQueue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;pcap.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;winsock2.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;datapackage.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Capture</span> : <span class="keyword">public</span> QThread</span><br><span class="line">&#123;</span><br><span class="line">     Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Capture</span>();</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">setPointer</span><span class="params">(<span class="type">pcap_t</span> *pointer)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setFlag</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">resetFlag</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">ethernetPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,QString&amp; info)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">ipPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,<span class="type">int</span>&amp;ipPackage)</span></span>;</span><br><span class="line">    <span class="function">QString <span class="title">arpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content)</span></span>;</span><br><span class="line">    <span class="function">QString <span class="title">icmpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">tcpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,QString &amp;info,<span class="type">int</span> ipPackage)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">udpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,QString&amp;info)</span></span>;</span><br><span class="line">    <span class="function">QString <span class="title">dnsPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content)</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">byteToHex</span><span class="params">(u_char *str, <span class="type">int</span> size)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">send</span><span class="params">(DataPackage data)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">pcap_t</span> *pointer;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">pcap_pkthdr</span>*header;</span><br><span class="line">    <span class="type">const</span> u_char *pkt_data;</span><br><span class="line">    <span class="type">time_t</span> local_time_version_sec;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">tm</span> local_time;</span><br><span class="line">    <span class="type">char</span> timeString[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">bool</span> isDone;<span class="comment">// done flag</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// CAPTURE_H</span></span></span><br></pre></td></tr></table></figure>

<p>3、capture.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;capture.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Capture::<span class="built_in">Capture</span>()&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;isDone = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;pointer = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;header = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;pkt_data = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Capture::setPointer</span><span class="params">(<span class="type">pcap_t</span> *pointer)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;pointer = pointer;</span><br><span class="line">    <span class="keyword">if</span>(pointer)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Capture::setFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;isDone = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Capture::resetFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;isDone = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">Capture::byteToHex</span><span class="params">(u_char *str, <span class="type">int</span> size)</span></span>&#123;</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; size;i++)&#123;</span><br><span class="line">        <span class="type">char</span> one = str[i] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span>(one &gt;= <span class="number">0x0A</span>)</span><br><span class="line">            one = one + <span class="number">0x41</span> - <span class="number">0x0A</span>;</span><br><span class="line">        <span class="keyword">else</span> one = one + <span class="number">0x30</span>;</span><br><span class="line">        <span class="type">char</span> two = str[i] &amp; <span class="number">0xF</span>;</span><br><span class="line">        <span class="keyword">if</span>(two &gt;= <span class="number">0x0A</span>)</span><br><span class="line">            two = two  + <span class="number">0x41</span> - <span class="number">0x0A</span>;</span><br><span class="line">        <span class="keyword">else</span> two = two + <span class="number">0x30</span>;</span><br><span class="line">        res.<span class="built_in">append</span>(one);</span><br><span class="line">        res.<span class="built_in">append</span>(two);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Capture::run</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> number_package = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(isDone)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="type">int</span> res = <span class="built_in">pcap_next_ex</span>(pointer,&amp;header,&amp;pkt_data);</span><br><span class="line">        <span class="keyword">if</span>(res == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        local_time_version_sec = header-&gt;ts.tv_sec;</span><br><span class="line">        <span class="built_in">localtime_s</span>(&amp;local_time,&amp;local_time_version_sec);</span><br><span class="line">        <span class="built_in">strftime</span>(timeString,<span class="built_in">sizeof</span>(timeString),<span class="string">&quot;%H:%M:%S&quot;</span>,&amp;local_time);</span><br><span class="line">        QString info = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> type = <span class="built_in">ethernetPackageHandle</span>(pkt_data,info);</span><br><span class="line">        <span class="keyword">if</span>(type)&#123;</span><br><span class="line">            DataPackage data;</span><br><span class="line">            <span class="type">int</span> len = header-&gt;len;</span><br><span class="line">            data.<span class="built_in">setPackageType</span>(type);</span><br><span class="line">            data.<span class="built_in">setTimeStamp</span>(<span class="built_in">QString</span>(timeString));</span><br><span class="line">            data.<span class="built_in">setDataLength</span>(len);</span><br><span class="line">            data.<span class="built_in">setPackagePointer</span>(pkt_data,len);</span><br><span class="line">            data.<span class="built_in">setPackageInfo</span>(info);</span><br><span class="line">            <span class="keyword">if</span>(data.pkt_content != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                <span class="function">emit <span class="title">send</span><span class="params">(data)</span></span>;</span><br><span class="line">                number_package++;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Capture::ethernetPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,QString&amp; info)</span></span>&#123;</span><br><span class="line">    ETHER_HEADER* ethernet;</span><br><span class="line">    u_short ethernet_type;</span><br><span class="line">    ethernet = (ETHER_HEADER*)pkt_content;</span><br><span class="line">    ethernet_type = <span class="built_in">ntohs</span>(ethernet-&gt;ether_type);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(ethernet_type)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0800</span>:&#123;<span class="comment">// ip package</span></span><br><span class="line">        <span class="type">int</span> dataPackage = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> res = <span class="built_in">ipPackageHandle</span>(pkt_content,dataPackage);</span><br><span class="line">        <span class="keyword">switch</span> (res) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:&#123;<span class="comment">// icmp package</span></span><br><span class="line">            info = <span class="built_in">icmpPackageHandle</span>(pkt_content);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:&#123;<span class="comment">// tcp package</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">tcpPackageHandle</span>(pkt_content,info,dataPackage);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">17</span>:&#123; <span class="comment">// udp package</span></span><br><span class="line">            <span class="type">int</span> type = <span class="built_in">udpPackageHandle</span>(pkt_content,info);</span><br><span class="line">            <span class="keyword">return</span> type;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0806</span>:&#123;<span class="comment">// arp package</span></span><br><span class="line">        info = <span class="built_in">arpPackageHandle</span>(pkt_content);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:&#123;<span class="comment">// undefined package</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ip package</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Capture::ipPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,<span class="type">int</span>&amp; ipPackage)</span></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">+------+-----+-----+</span></span><br><span class="line"><span class="comment">|   1  |  6  |  17 |</span></span><br><span class="line"><span class="comment">+------+-----+-----+</span></span><br><span class="line"><span class="comment">| ICMP | TCP | UDP |</span></span><br><span class="line"><span class="comment">+------+-----+-----+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    IP_HEADER* ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> protocol = ip-&gt;protocol;</span><br><span class="line">    ipPackage = (<span class="built_in">htons</span>(ip-&gt;total_length) - (ip-&gt;versiosn_head_length &amp; <span class="number">0x0F</span>) * <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">return</span> protocol;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// icmp package</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * part of the protocol of type and code</span></span><br><span class="line"><span class="comment"> * if you need detail information, pls check the official documents</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">| type | code |                   information                  |</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|  0   |   0  |     Echo response (ping command response)      |</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|      |   0  |             Network unreachable                |</span></span><br><span class="line"><span class="comment">+      +------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|      |   1  |             Host unreachable                   |</span></span><br><span class="line"><span class="comment">+      +------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|      |   2  |              Protocol unreachable              |</span></span><br><span class="line"><span class="comment">+      +------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|   3  |   3  |              Port unreachable                  |</span></span><br><span class="line"><span class="comment">+      +------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|      |   4  |    Fragmentation is required, but DF is set    |</span></span><br><span class="line"><span class="comment">+      +------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|      |   5  |        Source route selection failed           |</span></span><br><span class="line"><span class="comment">+      +------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|      |   6  |            Unknown target network              |</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|   4  |   0  | Source station suppression [congestion control]|</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|   5  |  any |                  Relocation                    |</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">|  8   |   0  |       Echo request (ping command request)      |</span></span><br><span class="line"><span class="comment">+------+------+------------------------------------------------+</span></span><br><span class="line"><span class="comment">......</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function">QString <span class="title">Capture::icmpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content)</span></span>&#123;</span><br><span class="line">    ICMP_HEADER*icmp;</span><br><span class="line">    icmp = (ICMP_HEADER*)(pkt_content + <span class="number">20</span> + <span class="number">14</span>);</span><br><span class="line">    u_char type = icmp-&gt;type;</span><br><span class="line">    u_char code = icmp-&gt;code;</span><br><span class="line">    QString result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">        <span class="keyword">if</span>(!code)</span><br><span class="line">            result = <span class="string">&quot;Echo response (ping)&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">        <span class="keyword">switch</span> (code) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Network unreachable&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Host unreachable&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Protocol unreachable&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Port unreachable&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Fragmentation is required, but DF is set&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Source route selection failed&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:&#123;</span><br><span class="line">            result = <span class="string">&quot;Unknown target network&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">        result = <span class="string">&quot;Source station suppression [congestion control]&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">        result = <span class="string">&quot;Relocation&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">8</span>:&#123;</span><br><span class="line">        <span class="keyword">if</span>(!code)</span><br><span class="line">            result = <span class="string">&quot;Echo request (ping)&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Capture::tcpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,QString &amp;info,<span class="type">int</span> ipPackage)</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    u_short src = <span class="built_in">ntohs</span>(tcp-&gt;src_port);</span><br><span class="line">    u_short des = <span class="built_in">ntohs</span>(tcp-&gt;des_port);</span><br><span class="line">    QString proSend = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    QString proRecv = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> type = <span class="number">3</span>;</span><br><span class="line">    <span class="type">int</span> delta = (tcp-&gt;header_length &gt;&gt; <span class="number">4</span>) * <span class="number">4</span>;</span><br><span class="line">    <span class="type">int</span> tcpPayLoad = ipPackage - delta;</span><br><span class="line">    <span class="keyword">if</span>((src == <span class="number">443</span> || des == <span class="number">443</span>) &amp;&amp; (tcpPayLoad &gt; <span class="number">0</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(src == <span class="number">443</span>)</span><br><span class="line">            proSend = <span class="string">&quot;(https)&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> proRecv = <span class="string">&quot;(https)&quot;</span>;</span><br><span class="line">        u_char *ssl;</span><br><span class="line">        ssl = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + delta);</span><br><span class="line">        u_char isTls = *(ssl);</span><br><span class="line">        ssl++;</span><br><span class="line">        u_short*pointer = (u_short*)(ssl);</span><br><span class="line">        u_short version = <span class="built_in">ntohs</span>(*pointer);</span><br><span class="line">        <span class="keyword">if</span>(isTls &gt;= <span class="number">20</span> &amp;&amp; isTls &lt;= <span class="number">23</span> &amp;&amp; version &gt;= <span class="number">0x0301</span> &amp;&amp; version &lt;= <span class="number">0x0304</span>)&#123;</span><br><span class="line">            type = <span class="number">6</span>;</span><br><span class="line">            <span class="keyword">switch</span>(isTls)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">20</span>:&#123;</span><br><span class="line">                info = <span class="string">&quot;Change Cipher Spec&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">21</span>:&#123;</span><br><span class="line">                info = <span class="string">&quot;Alert&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">22</span>:&#123;</span><br><span class="line">                info = <span class="string">&quot;Handshake&quot;</span>;</span><br><span class="line">                ssl += <span class="number">4</span>;</span><br><span class="line">                u_char type = (*ssl);</span><br><span class="line">                <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">                    info += <span class="string">&quot; Client Hello&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">                    info += <span class="string">&quot; Server hello&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>: &#123;</span><br><span class="line">                    info += <span class="string">&quot; New Session Ticket&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">11</span>:&#123;</span><br><span class="line">                    info += <span class="string">&quot; Certificate&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:&#123;</span><br><span class="line">                    info += <span class="string">&quot; Client Key Exchange&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">12</span>:&#123;</span><br><span class="line">                    info += <span class="string">&quot; Server Key Exchange&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">14</span>:&#123;</span><br><span class="line">                    info += <span class="string">&quot; Server Hello Done&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">23</span>:&#123;</span><br><span class="line">                info = <span class="string">&quot;Application Data&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">default</span>:&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> type;</span><br><span class="line">        &#125;<span class="keyword">else</span> type = <span class="number">7</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(type == <span class="number">7</span>)&#123;</span><br><span class="line">        info = <span class="string">&quot;Continuation Data&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        info += QString::<span class="built_in">number</span>(src) + proSend+ <span class="string">&quot;-&gt;&quot;</span> + QString::<span class="built_in">number</span>(des) + proRecv;</span><br><span class="line">        QString flag = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(tcp-&gt;flags &amp; <span class="number">0x08</span>) flag += <span class="string">&quot;PSH,&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(tcp-&gt;flags &amp; <span class="number">0x10</span>) flag += <span class="string">&quot;ACK,&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(tcp-&gt;flags &amp; <span class="number">0x02</span>) flag += <span class="string">&quot;SYN,&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(tcp-&gt;flags &amp; <span class="number">0x20</span>) flag += <span class="string">&quot;URG,&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(tcp-&gt;flags &amp; <span class="number">0x01</span>) flag += <span class="string">&quot;FIN,&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(tcp-&gt;flags &amp; <span class="number">0x04</span>) flag += <span class="string">&quot;RST,&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(flag != <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            flag = flag.<span class="built_in">left</span>(flag.<span class="built_in">length</span>()<span class="number">-1</span>);</span><br><span class="line">            info += <span class="string">&quot; [&quot;</span> + flag + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        u_int sequeue = <span class="built_in">ntohl</span>(tcp-&gt;sequence);</span><br><span class="line">        u_int ack = <span class="built_in">ntohl</span>(tcp-&gt;ack);</span><br><span class="line">        u_short window = <span class="built_in">ntohs</span>(tcp-&gt;window_size);</span><br><span class="line">        info += <span class="string">&quot; Seq=&quot;</span> + QString::<span class="built_in">number</span>(sequeue) + <span class="string">&quot; Ack=&quot;</span> + QString::<span class="built_in">number</span>(ack) + <span class="string">&quot; win=&quot;</span> + QString::<span class="built_in">number</span>(window) + <span class="string">&quot; Len=&quot;</span> + QString::<span class="built_in">number</span>(tcpPayLoad);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Capture::udpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content,QString&amp;info)</span></span>&#123;</span><br><span class="line">    UDP_HEADER * udp;</span><br><span class="line">    udp = (UDP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    u_short desPort = <span class="built_in">ntohs</span>(udp-&gt;des_port);</span><br><span class="line">    u_short srcPort = <span class="built_in">ntohs</span>(udp-&gt;src_port);</span><br><span class="line">    <span class="keyword">if</span>(desPort == <span class="number">53</span>)&#123; <span class="comment">// dns query</span></span><br><span class="line">        info =  <span class="built_in">dnsPackageHandle</span>(pkt_content);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(srcPort == <span class="number">53</span>)&#123;<span class="comment">// dns reply</span></span><br><span class="line">        info =  <span class="built_in">dnsPackageHandle</span>(pkt_content);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        QString res = QString::<span class="built_in">number</span>(srcPort) + <span class="string">&quot;-&gt;&quot;</span> + QString::<span class="built_in">number</span>(desPort);</span><br><span class="line">        res += <span class="string">&quot; len=&quot;</span> + QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(udp-&gt;data_length));</span><br><span class="line">        info = res;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">Capture::arpPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content)</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    u_short op = <span class="built_in">ntohs</span>(arp-&gt;op_code);</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    u_char*addr = arp-&gt;des_ip_addr;</span><br><span class="line"></span><br><span class="line">    QString desIp = QString::<span class="built_in">number</span>(*addr) + <span class="string">&quot;.&quot;</span></span><br><span class="line">            + QString::<span class="built_in">number</span>(*(addr+<span class="number">1</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">            + QString::<span class="built_in">number</span>(*(addr+<span class="number">2</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">            + QString::<span class="built_in">number</span>(*(addr+<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    addr = arp-&gt;src_ip_addr;</span><br><span class="line">    QString srcIp = QString::<span class="built_in">number</span>(*addr) + <span class="string">&quot;.&quot;</span></span><br><span class="line">            + QString::<span class="built_in">number</span>(*(addr+<span class="number">1</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">            + QString::<span class="built_in">number</span>(*(addr+<span class="number">2</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">            + QString::<span class="built_in">number</span>(*(addr+<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    u_char* srcEthTemp = arp-&gt;src_eth_addr;</span><br><span class="line">    QString srcEth = <span class="built_in">byteToHex</span>(srcEthTemp,<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">            + <span class="built_in">byteToHex</span>((srcEthTemp+<span class="number">1</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">            + <span class="built_in">byteToHex</span>((srcEthTemp+<span class="number">2</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">            + <span class="built_in">byteToHex</span>((srcEthTemp+<span class="number">3</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">            + <span class="built_in">byteToHex</span>((srcEthTemp+<span class="number">4</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">            + <span class="built_in">byteToHex</span>((srcEthTemp+<span class="number">5</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (op)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">        res  = <span class="string">&quot;Who has &quot;</span> + desIp + <span class="string">&quot;? Tell &quot;</span> + srcIp;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">        res = srcIp + <span class="string">&quot; is at &quot;</span> + srcEth;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">Capture::dnsPackageHandle</span><span class="params">(<span class="type">const</span> u_char *pkt_content)</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    u_short identification = <span class="built_in">ntohs</span>(dns-&gt;identification);</span><br><span class="line">    u_short type = <span class="built_in">ntohs</span>(dns-&gt;flags);</span><br><span class="line">    QString info = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>((type &amp; <span class="number">0xf800</span>) == <span class="number">0x0000</span>)&#123;</span><br><span class="line">        info = <span class="string">&quot;Standard query &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((type &amp; <span class="number">0xf800</span>) == <span class="number">0x8000</span>)&#123;</span><br><span class="line">        info = <span class="string">&quot;Standard query response &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    QString name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">char</span>*domain = (<span class="type">char</span>*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span> + <span class="number">12</span>);</span><br><span class="line">    <span class="keyword">while</span>(*domain != <span class="number">0x00</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(domain &amp;&amp; (*domain) &lt;= <span class="number">64</span>)&#123;</span><br><span class="line">            <span class="type">int</span> length = *domain;</span><br><span class="line">            domain++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; length;k++)&#123;</span><br><span class="line">                name += (*domain);</span><br><span class="line">                domain++;</span><br><span class="line">            &#125;</span><br><span class="line">            name += <span class="string">&quot;.&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// DNS_QUESITON *qus = (DNS_QUESITON*)(pkt_content + 14 + 20 + 8 + 12 + stringLength);</span></span><br><span class="line">    <span class="comment">// qDebug()&lt;&lt;ntohs(qus-&gt;query_type);</span></span><br><span class="line">    <span class="comment">// qDebug()&lt;&lt;ntohs(qus-&gt;query_class);</span></span><br><span class="line">    name = name.<span class="built_in">left</span>(name.<span class="built_in">length</span>()<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> info + <span class="string">&quot;0x&quot;</span> + QString::<span class="built_in">number</span>(identification,<span class="number">16</span>) + <span class="string">&quot; &quot;</span> + name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、datapackage.h</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> DATAPACKAGE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DATAPACKAGE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Format.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * This class is describe the data package infomation</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * | type| infomation |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  1  |    arp     |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  2  |    icmp    |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  3  |    tcp     |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  4  |    udp     |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  5  |    dns     |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  6  |    tls     |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment"> * |  7  |    ssl     |</span></span><br><span class="line"><span class="comment"> * +-----+------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataPackage</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    u_int data_length; <span class="comment">// data pakage length</span></span><br><span class="line">    QString timeStamp; <span class="comment">// timestamp of package</span></span><br><span class="line">    QString info;      <span class="comment">// a breif introduction of package</span></span><br><span class="line">    <span class="type">int</span> packageType;   <span class="comment">// type</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">const</span> u_char *pkt_content; <span class="comment">// root pointer of package data</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * turn the byteArray to QString</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">byteToHex</span><span class="params">(u_char*str,<span class="type">int</span> size)</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// Construction and destruction</span></span><br><span class="line">    <span class="built_in">DataPackage</span>();</span><br><span class="line">    ~<span class="built_in">DataPackage</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set the var</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setDataLength</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> length)</span></span>;                    <span class="comment">// set the package length</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setTimeStamp</span><span class="params">(QString timeStamp)</span></span>;                       <span class="comment">// set timestamp</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPackageType</span><span class="params">(<span class="type">int</span> type)</span></span>;                              <span class="comment">// set package type</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPackagePointer</span><span class="params">(<span class="type">const</span> u_char *pkt_content,<span class="type">int</span> size)</span></span>; <span class="comment">// set package pointer</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPackageInfo</span><span class="params">(QString info)</span></span>;                          <span class="comment">// set package information</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the var</span></span><br><span class="line">    <span class="function">QString <span class="title">getDataLength</span><span class="params">()</span></span>;                  <span class="comment">// get package length</span></span><br><span class="line">    <span class="function">QString <span class="title">getTimeStamp</span><span class="params">()</span></span>;                   <span class="comment">// get timestamp</span></span><br><span class="line">    <span class="function">QString <span class="title">getPackageType</span><span class="params">()</span></span>;                 <span class="comment">// get package type</span></span><br><span class="line">    <span class="function">QString <span class="title">getInfo</span><span class="params">()</span></span>;                        <span class="comment">// get a breif package information</span></span><br><span class="line">    <span class="function">QString <span class="title">getSource</span><span class="params">()</span></span>;                      <span class="comment">// get the source address of package</span></span><br><span class="line">    <span class="function">QString <span class="title">getDestination</span><span class="params">()</span></span>;                 <span class="comment">// get the destination address of package</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the mac info</span></span><br><span class="line">    <span class="function">QString <span class="title">getDesMacAddr</span><span class="params">()</span></span>;                  <span class="comment">// get the destination MAC address</span></span><br><span class="line">    <span class="function">QString <span class="title">getSrcMacAddr</span><span class="params">()</span></span>;                  <span class="comment">// get the source MAC address</span></span><br><span class="line">    <span class="function">QString <span class="title">getMacType</span><span class="params">()</span></span>;                     <span class="comment">// get the type of MAC address</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the ip info</span></span><br><span class="line">    <span class="function">QString <span class="title">getDesIpAddr</span><span class="params">()</span></span>;                   <span class="comment">// get the destination ip address</span></span><br><span class="line">    <span class="function">QString <span class="title">getSrcIpAddr</span><span class="params">()</span></span>;                   <span class="comment">// get the source ip address</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpVersion</span><span class="params">()</span></span>;                   <span class="comment">// get the ip version</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpHeaderLength</span><span class="params">()</span></span>;              <span class="comment">// get the ip head length</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpTos</span><span class="params">()</span></span>;                       <span class="comment">// get the ip tos</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpTotalLength</span><span class="params">()</span></span>;               <span class="comment">// get the ip total package length</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpIdentification</span><span class="params">()</span></span>;            <span class="comment">// get the ip identification</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpFlag</span><span class="params">()</span></span>;                      <span class="comment">// get the ip flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpReservedBit</span><span class="params">()</span></span>;               <span class="comment">// the reserved bit</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpDF</span><span class="params">()</span></span>;                        <span class="comment">// Don&#x27;t fragment</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpMF</span><span class="params">()</span></span>;                        <span class="comment">// More fragment</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpFragmentOffset</span><span class="params">()</span></span>;            <span class="comment">// get the offset of package</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpTTL</span><span class="params">()</span></span>;                       <span class="comment">// get ip ttl [time to live]</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpProtocol</span><span class="params">()</span></span>;                  <span class="comment">// get the ip protocol</span></span><br><span class="line">    <span class="function">QString <span class="title">getIpCheckSum</span><span class="params">()</span></span>;                  <span class="comment">// get the checksum</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the icmp info</span></span><br><span class="line">    <span class="function">QString <span class="title">getIcmpType</span><span class="params">()</span></span>;                    <span class="comment">// get the icmp type</span></span><br><span class="line">    <span class="function">QString <span class="title">getIcmpCode</span><span class="params">()</span></span>;                    <span class="comment">// get the icmp code</span></span><br><span class="line">    <span class="function">QString <span class="title">getIcmpCheckSum</span><span class="params">()</span></span>;                <span class="comment">// get the icmp checksum</span></span><br><span class="line">    <span class="function">QString <span class="title">getIcmpIdentification</span><span class="params">()</span></span>;          <span class="comment">// get the icmp identification</span></span><br><span class="line">    <span class="function">QString <span class="title">getIcmpSequeue</span><span class="params">()</span></span>;                 <span class="comment">// get the icmp sequence</span></span><br><span class="line">    <span class="function">QString <span class="title">getIcmpData</span><span class="params">(<span class="type">int</span> size)</span></span>;            <span class="comment">// get the icmp data</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the arp info</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpHardwareType</span><span class="params">()</span></span>;             <span class="comment">// get arp hardware type</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpProtocolType</span><span class="params">()</span></span>;             <span class="comment">// get arp protocol type</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpHardwareLength</span><span class="params">()</span></span>;           <span class="comment">// get arp hardware length</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpProtocolLength</span><span class="params">()</span></span>;           <span class="comment">// get arp protocol length</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpOperationCode</span><span class="params">()</span></span>;            <span class="comment">// get arp operation code</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpSourceEtherAddr</span><span class="params">()</span></span>;          <span class="comment">// get arp source ethernet address</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpSourceIpAddr</span><span class="params">()</span></span>;             <span class="comment">// get arp souce ip address</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpDestinationEtherAddr</span><span class="params">()</span></span>;     <span class="comment">// get arp destination ethernet address</span></span><br><span class="line">    <span class="function">QString <span class="title">getArpDestinationIpAddr</span><span class="params">()</span></span>;        <span class="comment">// get arp destination ip address</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the tcp info</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpSourcePort</span><span class="params">()</span></span>;               <span class="comment">// get tcp source port</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpDestinationPort</span><span class="params">()</span></span>;          <span class="comment">// get tcp destination port</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpSequence</span><span class="params">()</span></span>;                 <span class="comment">// get tcp sequence</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpAcknowledgment</span><span class="params">()</span></span>;           <span class="comment">// get acknowlegment</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpHeaderLength</span><span class="params">()</span></span>;             <span class="comment">// get tcp head length</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpRawHeaderLength</span><span class="params">()</span></span>;          <span class="comment">// get tcp raw head length [default is 0x05]</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpFlags</span><span class="params">()</span></span>;                    <span class="comment">// get tcp flags</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpPSH</span><span class="params">()</span></span>;                      <span class="comment">// PSH flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpACK</span><span class="params">()</span></span>;                      <span class="comment">// ACK flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpSYN</span><span class="params">()</span></span>;                      <span class="comment">// SYN flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpURG</span><span class="params">()</span></span>;                      <span class="comment">// URG flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpFIN</span><span class="params">()</span></span>;                      <span class="comment">// FIN flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpRST</span><span class="params">()</span></span>;                      <span class="comment">// RST flag</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpWindowSize</span><span class="params">()</span></span>;               <span class="comment">// get tcp window size</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpCheckSum</span><span class="params">()</span></span>;                 <span class="comment">// get tcp checksum</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpUrgentPointer</span><span class="params">()</span></span>;            <span class="comment">// get tcp urgent pointer</span></span><br><span class="line">    <span class="function">QString <span class="title">getTcpOperationKind</span><span class="params">(<span class="type">int</span> kind)</span></span>;    <span class="comment">// get tcp option kind</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getTcpOperationRawKind</span><span class="params">(<span class="type">int</span> offset)</span></span>;   <span class="comment">// get tcp raw option kind</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * tcp optional parts</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">getTcpOperationMSS</span><span class="params">(<span class="type">int</span> offset,u_short&amp; mss)</span></span>;                          <span class="comment">// kind = 2</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">getTcpOperationWSOPT</span><span class="params">(<span class="type">int</span> offset,u_char&amp;shit)</span></span>;                         <span class="comment">// kind = 3</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">getTcpOperationSACKP</span><span class="params">(<span class="type">int</span> offset)</span></span>;                                     <span class="comment">// kind = 4</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">getTcpOperationSACK</span><span class="params">(<span class="type">int</span> offset,u_char&amp;length,QVector&lt;u_int&gt;&amp;edge)</span></span>;    <span class="comment">// kind = 5</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">getTcpOperationTSPOT</span><span class="params">(<span class="type">int</span> offset,u_int&amp; value,u_int&amp;reply)</span></span>;            <span class="comment">// kind = 8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the udp info</span></span><br><span class="line">    <span class="function">QString <span class="title">getUdpSourcePort</span><span class="params">()</span></span>;               <span class="comment">// get udp source port</span></span><br><span class="line">    <span class="function">QString <span class="title">getUdpDestinationPort</span><span class="params">()</span></span>;          <span class="comment">// get udp destination port</span></span><br><span class="line">    <span class="function">QString <span class="title">getUdpDataLength</span><span class="params">()</span></span>;               <span class="comment">// get udp data length</span></span><br><span class="line">    <span class="function">QString <span class="title">getUdpCheckSum</span><span class="params">()</span></span>;                 <span class="comment">// get udp checksum</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the dns info</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsTransactionId</span><span class="params">()</span></span>;            <span class="comment">// get dns transaction id</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlags</span><span class="params">()</span></span>;                    <span class="comment">// get dns flags</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsQR</span><span class="params">()</span></span>;                  <span class="comment">// get dns flag QR</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsOpcode</span><span class="params">()</span></span>;              <span class="comment">// get dns flag operation code</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsAA</span><span class="params">()</span></span>;                  <span class="comment">// get dns flag AA</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsTC</span><span class="params">()</span></span>;                  <span class="comment">// get dns flag TC</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsRD</span><span class="params">()</span></span>;                  <span class="comment">// get dns flag RD</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsRA</span><span class="params">()</span></span>;                  <span class="comment">// get dns flag RA</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsZ</span><span class="params">()</span></span>;                   <span class="comment">// get dns flag Z [reserved]</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsFlagsRcode</span><span class="params">()</span></span>;               <span class="comment">// get dns flag Rcode</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsQuestionNumber</span><span class="params">()</span></span>;           <span class="comment">// get dns question number</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsAnswerNumber</span><span class="params">()</span></span>;             <span class="comment">// get dns answer number</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsAuthorityNumber</span><span class="params">()</span></span>;          <span class="comment">// get dns authority number</span></span><br><span class="line">    <span class="function">QString <span class="title">getDnsAdditionalNumber</span><span class="params">()</span></span>;         <span class="comment">// get dns addition number</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getDnsQueriesDomain</span><span class="params">(QString&amp;name,<span class="type">int</span>&amp;Type,<span class="type">int</span>&amp;Class)</span></span>;</span><br><span class="line">    <span class="function">QString <span class="title">getDnsDomainType</span><span class="params">(<span class="type">int</span> type)</span></span>;</span><br><span class="line">    <span class="function">QString <span class="title">getDnsDomainName</span><span class="params">(<span class="type">int</span> offset)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getDnsAnswersDomain</span><span class="params">(<span class="type">int</span> offset,QString&amp;name1,u_short&amp;Type,u_short&amp; Class,u_int&amp;ttl,u_short&amp;dataLength,QString&amp; name2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the tls info</span></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">getisTlsProtocol</span><span class="params">(<span class="type">int</span> offset)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsBasicInfo</span><span class="params">(<span class="type">int</span> offset,u_char&amp;contentType,u_short&amp;version,u_short&amp;length)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsClientHelloInfo</span><span class="params">(<span class="type">int</span> offset,u_char&amp;handShakeType,<span class="type">int</span>&amp; length,u_short&amp;version,QString&amp;random,u_char&amp;sessionIdLength,QString&amp;sessionId,u_short&amp;cipherLength,QVector&lt;u_short&gt;&amp;cipherSuit,u_char&amp; cmLength,QVector&lt;u_char&gt;&amp;CompressionMethod,u_short&amp;extensionLength)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsServerHelloInfo</span><span class="params">(<span class="type">int</span> offset,u_char&amp;handShakeType,<span class="type">int</span>&amp;length,u_short&amp;version,QString&amp; random,u_char&amp;sessionIdLength,QString&amp;sessionId,u_short&amp;cipherSuit,u_char&amp;compressionMethod,u_short&amp;extensionLength)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsServerKeyExchange</span><span class="params">(<span class="type">int</span> offset,u_char&amp;handShakeType,<span class="type">int</span>&amp;length,u_char&amp;curveType,u_short&amp;curveName,u_char&amp;pubLength,QString&amp;pubKey,u_short&amp;sigAlgorithm,u_short&amp;sigLength,QString&amp;sig)</span></span>;</span><br><span class="line">    <span class="function">u_short <span class="title">getTlsExtensionType</span><span class="params">(<span class="type">int</span> offset)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsHandshakeType</span><span class="params">(<span class="type">int</span> offset,u_char&amp;type)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * these functions are used to parse the extension parts</span></span><br><span class="line"><span class="comment">     * extension parts are common in handshake parts (client hello,server hello ...)</span></span><br><span class="line"><span class="comment">     * there are some extension types are not included in, maybe you should refer the official API</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionServerName</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_short&amp;listLength,u_char&amp;nameType,u_short&amp;nameLength,QString&amp; name)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionSignatureAlgorithms</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_short&amp;algorithmLength,QVector&lt;u_short&gt;&amp;signatureAlgorithm)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionSupportGroups</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_short&amp;groupListLength,QVector&lt;u_short&gt;&amp;group)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionEcPointFormats</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_char&amp; ecLength,QVector&lt;u_char&gt;&amp;EC)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionSessionTicket</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionEncryptThenMac</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionSupportVersions</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_char&amp;supportLength,QVector&lt;u_short&gt;&amp;supportVersion)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionPskKeyExchangeModes</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_char&amp;modeLength,QVector&lt;u_char&gt;&amp;mode)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionKeyShare</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,u_short&amp;shareLength,u_short&amp;group,u_short&amp;exchangeLength,QString&amp; exchange)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionOther</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,QString&amp; data)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionExtendMasterSecret</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">getTlsExtensionPadding</span><span class="params">(<span class="type">int</span> offset,u_short&amp;type,u_short&amp;length,QString&amp;data)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * when transfer data,some types will be encoded,like using 0x01 to represent the MD5 in extension hash part</span></span><br><span class="line"><span class="comment">     * to visual display these types,we need to decode and analysis</span></span><br><span class="line"><span class="comment">     * this functions are used to do these analisis</span></span><br><span class="line"><span class="comment">     * however,some types may be the custom types, so we can&#x27;t decode</span></span><br><span class="line"><span class="comment">     * also,there are some rules not be included, maybe you should refer the official API</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">// Parsing the encode data</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHandshakeType</span><span class="params">(<span class="type">int</span> type)</span></span>;                          <span class="comment">// Parsing TLS handshake type</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsContentType</span><span class="params">(<span class="type">int</span> type)</span></span>;                            <span class="comment">// Parsing TLS content type</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsVersion</span><span class="params">(<span class="type">int</span> version)</span></span>;                             <span class="comment">// Parsing TLS version</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHandshakeCipherSuites</span><span class="params">(u_short code)</span></span>;              <span class="comment">// Parsing TLS cipher suite</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHandshakeCompression</span><span class="params">(u_char code)</span></span>;                <span class="comment">// Parsing TLS compression</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHandshakeExtension</span><span class="params">(u_short type)</span></span>;                 <span class="comment">// Parsing TLS extension</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHandshakeExtensionECPointFormat</span><span class="params">(u_char type)</span></span>;     <span class="comment">// Parsing TLS EC point format</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHandshakeExtensionSupportGroup</span><span class="params">(u_short type)</span></span>;     <span class="comment">// Parsing TLS support group</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHadshakeExtensionSignature</span><span class="params">(u_char type)</span></span>;          <span class="comment">// Parsing TLS signature</span></span><br><span class="line">    <span class="function"><span class="type">static</span> QString <span class="title">getTlsHadshakeExtensionHash</span><span class="params">(u_char type)</span></span>;               <span class="comment">// Parsing TLS hash</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// DATAPACKAGE_H</span></span></span><br></pre></td></tr></table></figure>

<p>5、datapackage.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;datapackage.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMetaType&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;winsock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVector&gt;</span></span></span><br><span class="line"></span><br><span class="line">DataPackage::<span class="built_in">DataPackage</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// register the DataPackage type then</span></span><br><span class="line">    <span class="built_in">qRegisterMetaType</span>&lt;DataPackage&gt;(<span class="string">&quot;DataPackage&quot;</span>);</span><br><span class="line">    <span class="keyword">this</span>-&gt;timeStamp = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;data_length = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;packageType = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;pkt_content = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::setDataLength</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> length)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;data_length = length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::setTimeStamp</span><span class="params">(QString timeStamp)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;timeStamp = timeStamp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::setPackageType</span><span class="params">(<span class="type">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;packageType = type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::setPackagePointer</span><span class="params">(<span class="type">const</span> u_char *pkt_content,<span class="type">int</span> size)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;pkt_content = (u_char*)<span class="built_in">malloc</span>(size);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;pkt_content != <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="built_in">memcpy</span>((<span class="type">char</span>*)(<span class="keyword">this</span>-&gt;pkt_content),pkt_content,size);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">this</span>-&gt;pkt_content = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="comment">//  Do not use  `this-&gt;pkt_content = pkt_content;`</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::setPackageInfo</span><span class="params">(QString info)</span></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;info = info;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">QString <span class="title">DataPackage::byteToHex</span><span class="params">(u_char *str, <span class="type">int</span> size)</span></span>&#123;</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; size;i++)&#123;</span><br><span class="line">        <span class="type">char</span> one = str[i] &gt;&gt; <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span>(one &gt;= <span class="number">0x0A</span>)</span><br><span class="line">            one = one + <span class="number">0x41</span> - <span class="number">0x0A</span>;</span><br><span class="line">        <span class="keyword">else</span> one = one + <span class="number">0x30</span>;</span><br><span class="line">        <span class="type">char</span> two = str[i] &amp; <span class="number">0xF</span>;</span><br><span class="line">        <span class="keyword">if</span>(two &gt;= <span class="number">0x0A</span>)</span><br><span class="line">            two = two  + <span class="number">0x41</span> - <span class="number">0x0A</span>;</span><br><span class="line">        <span class="keyword">else</span> two = two + <span class="number">0x30</span>;</span><br><span class="line">        res.<span class="built_in">append</span>(one);</span><br><span class="line">        res.<span class="built_in">append</span>(two);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTimeStamp</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>-&gt;timeStamp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDataLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="keyword">this</span>-&gt;data_length);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getPackageType</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">this</span>-&gt;packageType) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> ARP;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> ICMP;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">return</span> TCP;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">return</span> UDP;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:<span class="keyword">return</span> DNS;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">return</span> TLS;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:<span class="keyword">return</span> SSL;</span><br><span class="line">    <span class="comment">// TODU ...more protocol you can add</span></span><br><span class="line">    <span class="keyword">default</span>:&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> info;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;packageType == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getArpSourceIpAddr</span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">getSrcIpAddr</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDestination</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>-&gt;packageType == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getArpDestinationIpAddr</span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">getDesIpAddr</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* Ether */</span></span><br><span class="line"><span class="comment">/********************** get destination ethenet address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDesMacAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ETHER_HEADER*ethernet;</span><br><span class="line">    ethernet = (ETHER_HEADER*)pkt_content;</span><br><span class="line">    u_char*addr;</span><br><span class="line">    <span class="keyword">if</span>(ethernet)&#123;</span><br><span class="line">        addr = ethernet-&gt;ether_des_host;</span><br><span class="line">        <span class="keyword">if</span>(addr)&#123;</span><br><span class="line">            QString res = <span class="built_in">byteToHex</span>(addr,<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">1</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">2</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">3</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">4</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">5</span>),<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(res == <span class="string">&quot;FF:FF:FF:FF:FF:FF&quot;</span>) <span class="keyword">return</span> <span class="string">&quot;FF:FF:FF:FF:FF:FF(Broadcast)&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get source ethenet address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getSrcMacAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ETHER_HEADER*ethernet;</span><br><span class="line">    ethernet = (ETHER_HEADER*)pkt_content;</span><br><span class="line">    u_char*addr;</span><br><span class="line">    <span class="keyword">if</span>(ethernet)&#123;</span><br><span class="line">        addr = ethernet-&gt;ether_src_host;</span><br><span class="line">        <span class="keyword">if</span>(addr)&#123;</span><br><span class="line">            QString res = <span class="built_in">byteToHex</span>(addr,<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">1</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">2</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">3</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">4</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">5</span>),<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(res == <span class="string">&quot;FF:FF:FF:FF:FF:FF&quot;</span>) <span class="keyword">return</span> <span class="string">&quot;FF:FF:FF:FF:FF:FF(Broadcast)&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ethenet type **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getMacType</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ETHER_HEADER*ethernet;</span><br><span class="line">    ethernet = (ETHER_HEADER*)pkt_content;</span><br><span class="line">    u_short ethernet_type = <span class="built_in">ntohs</span>(ethernet-&gt;ether_type);</span><br><span class="line">    <span class="keyword">switch</span> (ethernet_type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0800</span>: <span class="keyword">return</span> <span class="string">&quot;IPv4(0x800)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0806</span>:<span class="keyword">return</span> <span class="string">&quot;ARP(0x0806)&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ip */</span></span><br><span class="line"><span class="comment">/********************** get destination ip address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDesIpAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    sockaddr_in desAddr;</span><br><span class="line">    desAddr.sin_addr.s_addr = ip-&gt;des_addr;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">QString</span>(<span class="built_in">inet_ntoa</span>(desAddr.sin_addr));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get source ip address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getSrcIpAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    sockaddr_in srcAddr;</span><br><span class="line">    srcAddr.sin_addr.s_addr = ip-&gt;src_addr;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">QString</span>(<span class="built_in">inet_ntoa</span>(srcAddr.sin_addr));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip version **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpVersion</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(ip-&gt;versiosn_head_length &gt;&gt; <span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip header length **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpHeaderLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> length = ip-&gt;versiosn_head_length &amp; <span class="number">0x0F</span>;</span><br><span class="line">    <span class="keyword">if</span>(length == <span class="number">5</span>) res = <span class="string">&quot;20 bytes (5)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> res = QString::<span class="built_in">number</span>(length*<span class="number">5</span>) + <span class="string">&quot;bytes (&quot;</span> + QString::<span class="built_in">number</span>(length) + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************** get ip TOS **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpTos</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(ip-&gt;TOS));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip total length **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpTotalLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(ip-&gt;total_length));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip indentification **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpIdentification</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(ip-&gt;identification),<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip flag **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpFlag</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(ip-&gt;flag_offset)&amp; <span class="number">0xe000</span>) &gt;&gt; <span class="number">8</span>,<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip reverse bit **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpReservedBit</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> bit = (<span class="built_in">ntohs</span>(ip-&gt;flag_offset) &amp; <span class="number">0x8000</span>) &gt;&gt; <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(bit);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip DF flag[Don&#x27;t Fragment] **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpDF</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(ip-&gt;flag_offset) &amp; <span class="number">0x4000</span>) &gt;&gt; <span class="number">14</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip MF flag[More Fragment] **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpMF</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(ip-&gt;flag_offset) &amp; <span class="number">0x2000</span>) &gt;&gt; <span class="number">13</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip Fragment Offset **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpFragmentOffset</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(ip-&gt;flag_offset) &amp; <span class="number">0x1FFF</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip TTL **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpTTL</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(ip-&gt;ttl);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip protocol **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpProtocol</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> protocol = ip-&gt;protocol;</span><br><span class="line">    <span class="keyword">switch</span> (protocol) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="string">&quot;ICMP (1)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">return</span> <span class="string">&quot;TCP (6)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">17</span>:<span class="keyword">return</span> <span class="string">&quot;UDP (17)&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get ip checksum **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIpCheckSum</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IP_HEADER*ip;</span><br><span class="line">    ip = (IP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(ip-&gt;checksum),<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* icmp */</span></span><br><span class="line"><span class="comment">/********************** get icmp type **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIcmpType</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ICMP_HEADER*icmp;</span><br><span class="line">    icmp = (ICMP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(icmp-&gt;type));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get icmp code **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIcmpCode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ICMP_HEADER*icmp;</span><br><span class="line">    icmp = (ICMP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(icmp-&gt;code));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get icmp checksum **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIcmpCheckSum</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ICMP_HEADER*icmp;</span><br><span class="line">    icmp = (ICMP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(icmp-&gt;checksum),<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get icmp identification **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIcmpIdentification</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ICMP_HEADER*icmp;</span><br><span class="line">    icmp = (ICMP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(icmp-&gt;identification));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get icmp sequence **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIcmpSequeue</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ICMP_HEADER*icmp;</span><br><span class="line">    icmp = (ICMP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(icmp-&gt;sequence));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getIcmpData</span><span class="params">(<span class="type">int</span> size)</span></span>&#123;</span><br><span class="line">    <span class="type">char</span>*icmp;</span><br><span class="line">    icmp = (<span class="type">char</span>*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    QString res= <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; size;i++)&#123;</span><br><span class="line">        res += (*icmp);</span><br><span class="line">        icmp++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* arp info */</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpHardwareType</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> type = <span class="built_in">ntohs</span>(arp-&gt;hardware_type);</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(type == <span class="number">0x0001</span>) res = <span class="string">&quot;Ethernet(1)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> res = QString::<span class="built_in">number</span>(type);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp protocol type **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpProtocolType</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> type = <span class="built_in">ntohs</span>(arp-&gt;protocol_type);</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(type == <span class="number">0x0800</span>) res = <span class="string">&quot;IPv4(0x0800)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> res = QString::<span class="built_in">number</span>(type);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get hardware length **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpHardwareLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(arp-&gt;mac_length);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp protocol length **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpProtocolLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(arp-&gt;ip_length);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp operator code **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpOperationCode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> code = <span class="built_in">ntohs</span>(arp-&gt;op_code);</span><br><span class="line">    QString res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(code == <span class="number">1</span>) res  = <span class="string">&quot;request(1)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(code == <span class="number">2</span>) res = <span class="string">&quot;reply(2)&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp source ethernet address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpSourceEtherAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    u_char*addr;</span><br><span class="line">    <span class="keyword">if</span>(arp)&#123;</span><br><span class="line">        addr = arp-&gt;src_eth_addr;</span><br><span class="line">        <span class="keyword">if</span>(addr)&#123;</span><br><span class="line">            QString res = <span class="built_in">byteToHex</span>(addr,<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">1</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">2</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">3</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">4</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">5</span>),<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp destination ethernet address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpDestinationEtherAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    u_char*addr;</span><br><span class="line">    <span class="keyword">if</span>(arp)&#123;</span><br><span class="line">        addr = arp-&gt;des_eth_addr;</span><br><span class="line">        <span class="keyword">if</span>(addr)&#123;</span><br><span class="line">            QString res = <span class="built_in">byteToHex</span>(addr,<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">1</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">2</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">3</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">4</span>),<span class="number">1</span>) + <span class="string">&quot;:&quot;</span></span><br><span class="line">                    + <span class="built_in">byteToHex</span>((addr+<span class="number">5</span>),<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp source ip address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpSourceIpAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">if</span>(arp)&#123;</span><br><span class="line">        u_char*addr = arp-&gt;src_ip_addr;</span><br><span class="line">        QString srcIp = QString::<span class="built_in">number</span>(*addr) + <span class="string">&quot;.&quot;</span></span><br><span class="line">                + QString::<span class="built_in">number</span>(*(addr+<span class="number">1</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">                + QString::<span class="built_in">number</span>(*(addr+<span class="number">2</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">                + QString::<span class="built_in">number</span>(*(addr+<span class="number">3</span>));</span><br><span class="line">        <span class="keyword">return</span> srcIp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get arp destination ip address **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getArpDestinationIpAddr</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ARP_HEADER*arp;</span><br><span class="line">    arp = (ARP_HEADER*)(pkt_content + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">if</span>(arp)&#123;</span><br><span class="line">        u_char*addr = arp-&gt;des_ip_addr;</span><br><span class="line">        QString desIp = QString::<span class="built_in">number</span>(*addr) + <span class="string">&quot;.&quot;</span></span><br><span class="line">                + QString::<span class="built_in">number</span>(*(addr+<span class="number">1</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">                + QString::<span class="built_in">number</span>(*(addr+<span class="number">2</span>)) + <span class="string">&quot;.&quot;</span></span><br><span class="line">                + QString::<span class="built_in">number</span>(*(addr+<span class="number">3</span>));</span><br><span class="line">        <span class="keyword">return</span> desIp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* tcp */</span></span><br><span class="line"><span class="comment">/********************** get tcp source port **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpSourcePort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> port = <span class="built_in">ntohs</span>(tcp-&gt;src_port);</span><br><span class="line">    <span class="keyword">if</span>(port == <span class="number">443</span>) <span class="keyword">return</span> <span class="string">&quot;https(443)&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(port);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp destination port **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpDestinationPort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> port = <span class="built_in">ntohs</span>(tcp-&gt;des_port);</span><br><span class="line">    <span class="keyword">if</span>(port == <span class="number">443</span>) <span class="keyword">return</span> <span class="string">&quot;https(443)&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(port);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp sequence **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpSequence</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohl</span>(tcp-&gt;sequence));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp acknowledgment **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpAcknowledgment</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohl</span>(tcp-&gt;ack));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp header length **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpHeaderLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="type">int</span> length = (tcp-&gt;header_length &gt;&gt; <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">if</span>(length == <span class="number">5</span>) <span class="keyword">return</span> <span class="string">&quot;20 bytes (5)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> QString::<span class="built_in">number</span>(length*<span class="number">4</span>) + <span class="string">&quot; bytes (&quot;</span> + QString::<span class="built_in">number</span>(length) + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpRawHeaderLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(tcp-&gt;header_length &gt;&gt; <span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************** get tcp flags **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpFlags</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(tcp-&gt;flags,<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************** get tcp PSH **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpPSH</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(((tcp-&gt;flags) &amp; <span class="number">0x08</span>) &gt;&gt; <span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp ACK **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpACK</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(((tcp-&gt;flags) &amp; <span class="number">0x10</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp SYN **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpSYN</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(((tcp-&gt;flags) &amp; <span class="number">0x02</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp UGR **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpURG</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(((tcp-&gt;flags) &amp; <span class="number">0x20</span>) &gt;&gt; <span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp FIN **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpFIN</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((tcp-&gt;flags) &amp; <span class="number">0x01</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp RST **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpRST</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(((tcp-&gt;flags) &amp; <span class="number">0x04</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp window size **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpWindowSize</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(tcp-&gt;window_size));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp checksum **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpCheckSum</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(tcp-&gt;checksum),<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tcp urgent pointer **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpUrgentPointer</span><span class="params">()</span></span>&#123;</span><br><span class="line">    TCP_HEADER*tcp;</span><br><span class="line">    tcp = (TCP_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(tcp-&gt;urgent));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTcpOperationKind</span><span class="params">(<span class="type">int</span> kind)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(kind)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">return</span> <span class="string">&quot;EOL&quot;</span>;              <span class="comment">// end of list</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="string">&quot;NOP&quot;</span>;              <span class="comment">// no operation</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> <span class="string">&quot;MSS&quot;</span>;              <span class="comment">// max segment</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">return</span> <span class="string">&quot;WSOPT&quot;</span>;            <span class="comment">// window scaling factor</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">return</span> <span class="string">&quot;SACK-Premitted&quot;</span>;   <span class="comment">// support SACK</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:<span class="keyword">return</span> <span class="string">&quot;SACK&quot;</span>;             <span class="comment">// SACK Block</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">8</span>:<span class="keyword">return</span> <span class="string">&quot;TSPOT&quot;</span>;            <span class="comment">// Timestamps</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">19</span>:<span class="keyword">return</span> <span class="string">&quot;TCP-MD5&quot;</span>;         <span class="comment">// MD5</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">28</span>:<span class="keyword">return</span> <span class="string">&quot;UTP&quot;</span>;             <span class="comment">// User Timeout</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">29</span>:<span class="keyword">return</span> <span class="string">&quot;TCP-AO&quot;</span>;          <span class="comment">// authenticated</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DataPackage::getTcpOperationRawKind</span><span class="params">(<span class="type">int</span> offset)</span></span>&#123;</span><br><span class="line">    u_char*tcp;</span><br><span class="line">    tcp = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">return</span> *tcp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">DataPackage::getTcpOperationSACK</span><span class="params">(<span class="type">int</span> offset,u_char&amp;length,QVector&lt;u_int&gt;&amp;edge)</span></span>&#123;</span><br><span class="line">    u_char*tcp;</span><br><span class="line">    tcp = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">if</span>(*tcp == <span class="number">5</span>)&#123;</span><br><span class="line">        tcp++;</span><br><span class="line">        length = *tcp;</span><br><span class="line">        tcp++;</span><br><span class="line">        u_int* pointer = (u_int*)tcp;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; (length - <span class="number">2</span>)/<span class="number">4</span>;i++)&#123;</span><br><span class="line">            u_int temp = <span class="built_in">htonl</span>(*pointer);</span><br><span class="line">            edge.<span class="built_in">push_back</span>(temp);</span><br><span class="line">            pointer++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">DataPackage::getTcpOperationMSS</span><span class="params">(<span class="type">int</span> offset, u_short &amp;mss)</span></span>&#123;</span><br><span class="line">    u_char *tcp;</span><br><span class="line">    tcp = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">if</span>(*tcp == <span class="number">2</span>)&#123;</span><br><span class="line">        tcp++;</span><br><span class="line">        <span class="keyword">if</span>(*tcp == <span class="number">4</span>)&#123;</span><br><span class="line">            tcp++;</span><br><span class="line">            u_short* Mss = (u_short*)tcp;</span><br><span class="line">            mss = <span class="built_in">ntohs</span>(*Mss);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">DataPackage::getTcpOperationSACKP</span><span class="params">(<span class="type">int</span> offset)</span></span>&#123;</span><br><span class="line">    u_char *tcp;</span><br><span class="line">    tcp = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">if</span>(*tcp == <span class="number">4</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">DataPackage::getTcpOperationWSOPT</span><span class="params">(<span class="type">int</span> offset, u_char &amp;shit)</span></span>&#123;</span><br><span class="line">    u_char *tcp;</span><br><span class="line">    tcp = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">if</span>(*tcp == <span class="number">3</span>)&#123;</span><br><span class="line">        tcp++;</span><br><span class="line">        <span class="keyword">if</span>(*tcp == <span class="number">3</span>)&#123;</span><br><span class="line">            tcp++;</span><br><span class="line">            shit = *tcp;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">DataPackage::getTcpOperationTSPOT</span><span class="params">(<span class="type">int</span> offset, u_int &amp;value, u_int &amp;reply)</span></span>&#123;</span><br><span class="line">    u_char *tcp;</span><br><span class="line">    tcp = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset + <span class="number">20</span>);</span><br><span class="line">    <span class="keyword">if</span>(*tcp == <span class="number">8</span>)&#123;</span><br><span class="line">        tcp++;</span><br><span class="line">        <span class="keyword">if</span>(*tcp == <span class="number">10</span>)&#123;</span><br><span class="line">            tcp++;</span><br><span class="line">            u_int *pointer = (u_int*)(tcp);</span><br><span class="line">            value = <span class="built_in">ntohl</span>(*pointer);</span><br><span class="line">            pointer++;</span><br><span class="line">            reply = <span class="built_in">ntohl</span>(*pointer);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* udp */</span></span><br><span class="line"><span class="comment">/********************** get udp source port **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getUdpSourcePort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    UDP_HEADER*udp;</span><br><span class="line">    udp = (UDP_HEADER*)(pkt_content + <span class="number">20</span> + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> port = <span class="built_in">ntohs</span>(udp-&gt;src_port);</span><br><span class="line">    <span class="keyword">if</span>(port == <span class="number">53</span>) <span class="keyword">return</span> <span class="string">&quot;domain(53)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> QString::<span class="built_in">number</span>(port);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get udp destination port **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getUdpDestinationPort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    UDP_HEADER*udp;</span><br><span class="line">    udp = (UDP_HEADER*)(pkt_content + <span class="number">20</span> + <span class="number">14</span>);</span><br><span class="line">    <span class="type">int</span> port = <span class="built_in">ntohs</span>(udp-&gt;des_port);</span><br><span class="line">    <span class="keyword">if</span>(port == <span class="number">53</span>) <span class="keyword">return</span> <span class="string">&quot;domain(53)&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> QString::<span class="built_in">number</span>(port);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get udp data length **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getUdpDataLength</span><span class="params">()</span></span>&#123;</span><br><span class="line">    UDP_HEADER*udp;</span><br><span class="line">    udp = (UDP_HEADER*)(pkt_content + <span class="number">20</span> + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(udp-&gt;data_length));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get udp checksum **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getUdpCheckSum</span><span class="params">()</span></span>&#123;</span><br><span class="line">    UDP_HEADER*udp;</span><br><span class="line">    udp = (UDP_HEADER*)(pkt_content + <span class="number">20</span> + <span class="number">14</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(udp-&gt;checksum),<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* dns */</span></span><br><span class="line"><span class="comment">/********************** get dns transaction **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsTransactionId</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(dns-&gt;identification),<span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns flag **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlags</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="type">int</span> type = <span class="built_in">ntohs</span>(dns-&gt;flags);</span><br><span class="line">    QString info = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>((type &amp; <span class="number">0xf800</span>) == <span class="number">0x0000</span>)&#123;</span><br><span class="line">        info = <span class="string">&quot;(Standard query)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>((type &amp; <span class="number">0xf800</span>) == <span class="number">0x8000</span>)&#123;</span><br><span class="line">        info = <span class="string">&quot;(Standard query response)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(type,<span class="number">16</span>) + info;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns QR **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsQR</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x8000</span>) &gt;&gt; <span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Operation code **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsOpcode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x7800</span>) &gt;&gt; <span class="number">11</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns AA **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsAA</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x0400</span>) &gt;&gt; <span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns TC **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsTC</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x0200</span>) &gt;&gt; <span class="number">9</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns RD **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsRD</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x0100</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns RA **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsRA</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x0080</span>) &gt;&gt; <span class="number">7</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Z(reserved) **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsZ</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x0070</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Response code **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsFlagsRcode</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>((<span class="built_in">ntohs</span>(dns-&gt;flags) &amp; <span class="number">0x000f</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Question number **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsQuestionNumber</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(dns-&gt;question));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Answer number **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsAnswerNumber</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(dns-&gt;answer));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Authority number **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsAuthorityNumber</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(dns-&gt;authority));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns Additional number **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsAdditionalNumber</span><span class="params">()</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="keyword">return</span> QString::<span class="built_in">number</span>(<span class="built_in">ntohs</span>(dns-&gt;additional));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns query result **********************/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getDnsQueriesDomain</span><span class="params">(QString&amp;name,<span class="type">int</span>&amp;Type,<span class="type">int</span>&amp;Class)</span></span>&#123;</span><br><span class="line">    DNS_HEADER*dns;</span><br><span class="line">    dns = (DNS_HEADER*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span>);</span><br><span class="line">    <span class="type">char</span>*domain = (<span class="type">char</span>*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span> + <span class="number">12</span>);</span><br><span class="line">    <span class="keyword">while</span>(*domain != <span class="number">0x00</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(domain &amp;&amp; (*domain) &lt;= <span class="number">64</span>)&#123;</span><br><span class="line">            <span class="type">int</span> length = *domain;</span><br><span class="line">            domain++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; length;k++)&#123;</span><br><span class="line">                name += (*domain);</span><br><span class="line">                domain++;</span><br><span class="line">            &#125;</span><br><span class="line">            name += <span class="string">&quot;.&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    domain++;</span><br><span class="line">    name = name.<span class="built_in">left</span>(name.<span class="built_in">length</span>() - <span class="number">1</span>);</span><br><span class="line">    DNS_QUESITON *qus = (DNS_QUESITON*)(domain);</span><br><span class="line">    Type = <span class="built_in">ntohs</span>(qus-&gt;query_type);</span><br><span class="line">    Class = <span class="built_in">ntohs</span>(qus-&gt;query_class);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns domian name **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsDomainName</span><span class="params">(<span class="type">int</span> offset)</span></span>&#123;</span><br><span class="line">    <span class="type">char</span>*dns;</span><br><span class="line">    dns = (<span class="type">char</span>*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span> + offset);</span><br><span class="line">    QString name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span>(dns &amp;&amp; *dns != <span class="number">0x00</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="type">unsigned</span> <span class="type">char</span>)(*dns) &lt;= <span class="number">64</span>)&#123;</span><br><span class="line">            <span class="type">int</span> length = *dns;</span><br><span class="line">            dns++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k&lt;length;k++)&#123;</span><br><span class="line">                name += (*dns);</span><br><span class="line">                dns++;</span><br><span class="line">            &#125;</span><br><span class="line">            name += <span class="string">&quot;.&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(((*dns) &amp; <span class="number">0xc0</span>) == <span class="number">0xc0</span>)&#123;</span><br><span class="line">            <span class="type">int</span> accOffset = (((*dns) &amp; <span class="number">0x3f</span>) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">            dns++;</span><br><span class="line">            accOffset += (<span class="type">unsigned</span> <span class="type">char</span>)(*dns);</span><br><span class="line">            name += <span class="built_in">getDnsDomainName</span>(accOffset) + <span class="string">&quot;.&quot;</span>;</span><br><span class="line">            dns++;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    name = name.<span class="built_in">left</span>(name.<span class="built_in">length</span>() - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns answer result **********************/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DataPackage::getDnsAnswersDomain</span><span class="params">(<span class="type">int</span> offset, QString &amp;name1, u_short &amp;Type, u_short &amp;Class, u_int &amp;ttl, u_short &amp;dataLength,QString&amp;name2)</span></span>&#123;</span><br><span class="line">    <span class="type">char</span>*dns = (<span class="type">char</span>*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">8</span> + <span class="number">12</span> + offset);</span><br><span class="line">    <span class="keyword">if</span>(((*dns) &amp; <span class="number">0xc0</span>) == <span class="number">0xc0</span>)&#123;</span><br><span class="line">        <span class="type">int</span> accOffset = (((*dns) &amp; <span class="number">0x3f</span>) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">        dns++; <span class="comment">//</span></span><br><span class="line">        accOffset += (*dns);</span><br><span class="line">        name1 = <span class="built_in">getDnsDomainName</span>(accOffset);</span><br><span class="line">        dns++; <span class="comment">//</span></span><br><span class="line">        DNS_ANSWER*answer = (DNS_ANSWER*)(dns);</span><br><span class="line">        Type = <span class="built_in">ntohs</span>(answer-&gt;answer_type);</span><br><span class="line">        Class = <span class="built_in">ntohs</span>(answer-&gt;answer_class);</span><br><span class="line">        ttl = <span class="built_in">ntohl</span>(answer-&gt;TTL);</span><br><span class="line">        dataLength = <span class="built_in">ntohs</span>(answer-&gt;dataLength);</span><br><span class="line">        dns += (<span class="number">2</span> + <span class="number">2</span> + <span class="number">4</span> + <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span>(dataLength == <span class="number">4</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line">                name2 += QString::<span class="built_in">number</span>((<span class="type">unsigned</span> <span class="type">char</span>)(*dns));</span><br><span class="line">                name2 += <span class="string">&quot;.&quot;</span>;</span><br><span class="line">                dns++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k&lt;dataLength;k++)&#123;</span><br><span class="line">                <span class="keyword">if</span>((<span class="type">unsigned</span> <span class="type">char</span>)(*dns) &lt;= <span class="number">64</span>)&#123;</span><br><span class="line">                    <span class="type">int</span> length = *dns;</span><br><span class="line">                    dns++;</span><br><span class="line">                    k++;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt; length;j++)&#123;</span><br><span class="line">                        name2 += *dns;</span><br><span class="line">                        dns++;</span><br><span class="line">                        k++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    name2 += <span class="string">&quot;.&quot;</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(((*dns) &amp; <span class="number">0xc0</span>) == <span class="number">0xc0</span>)&#123;</span><br><span class="line">                    <span class="type">int</span> accOffset = (((*dns) &amp; <span class="number">0x3f</span>) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                    dns++;</span><br><span class="line">                    k++;</span><br><span class="line">                    accOffset += (<span class="type">unsigned</span> <span class="type">char</span>)(*dns);</span><br><span class="line">                    name2 += <span class="built_in">getDnsDomainName</span>(accOffset) + <span class="string">&quot;.&quot;</span>;</span><br><span class="line">                    dns++;</span><br><span class="line">                    k++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        name2 = name2.<span class="built_in">left</span>(name2.<span class="built_in">length</span>() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> dataLength + <span class="number">2</span> + <span class="number">2</span> + <span class="number">2</span> + <span class="number">4</span> + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        name1 = <span class="built_in">getDnsDomainName</span>(offset + <span class="number">12</span>);</span><br><span class="line">        DNS_ANSWER*answer = (DNS_ANSWER*)(dns + name1.<span class="built_in">size</span>() + <span class="number">2</span>);</span><br><span class="line">        Type = <span class="built_in">ntohs</span>(answer-&gt;answer_type);</span><br><span class="line">        Class = <span class="built_in">ntohs</span>(answer-&gt;answer_class);</span><br><span class="line">        ttl = <span class="built_in">ntohl</span>(answer-&gt;TTL);</span><br><span class="line">        dataLength = <span class="built_in">ntohs</span>(answer-&gt;dataLength);</span><br><span class="line">        <span class="keyword">if</span>(dataLength == <span class="number">4</span>)&#123;</span><br><span class="line">            dns += (<span class="number">2</span> + <span class="number">2</span> + <span class="number">4</span> + <span class="number">2</span> + name1.<span class="built_in">size</span>() + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">4</span>;i++)&#123;</span><br><span class="line">                name2 += (<span class="type">unsigned</span> <span class="type">char</span>)(*dns);</span><br><span class="line">                dns++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k&lt;dataLength;k++)&#123;</span><br><span class="line">                <span class="keyword">if</span>((<span class="type">unsigned</span> <span class="type">char</span>)(*dns) &lt;= <span class="number">64</span>)&#123;</span><br><span class="line">                    <span class="type">int</span> length = *dns;</span><br><span class="line">                    dns++;</span><br><span class="line">                    k++;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt; length;j++)&#123;</span><br><span class="line">                        name2 += *dns;</span><br><span class="line">                        dns++;</span><br><span class="line">                        k++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    name2 += <span class="string">&quot;.&quot;</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(((*dns) &amp; <span class="number">0xc0</span>) == <span class="number">0xc0</span>)&#123;</span><br><span class="line">                    <span class="type">int</span> accOffset = (((*dns) &amp; <span class="number">0x3f</span>) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                    dns++;</span><br><span class="line">                    k++;</span><br><span class="line">                    accOffset += (*dns);</span><br><span class="line">                    name2 += <span class="built_in">getDnsDomainName</span>(accOffset);</span><br><span class="line">                    dns++;</span><br><span class="line">                    k++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        name2 = name2.<span class="built_in">left</span>(name2.<span class="built_in">length</span>() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> dataLength + <span class="number">2</span> + <span class="number">2</span> + <span class="number">2</span> + <span class="number">4</span> + <span class="number">2</span> + name1.<span class="built_in">size</span>() + <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get dns domain type **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getDnsDomainType</span><span class="params">(<span class="type">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> <span class="string">&quot;A (Host Address)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> <span class="string">&quot;NS&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:<span class="keyword">return</span> <span class="string">&quot;CNAME (Canonical NAME for an alias)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">return</span> <span class="string">&quot;SOA&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11</span>:<span class="keyword">return</span> <span class="string">&quot;WSK&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">12</span>:<span class="keyword">return</span> <span class="string">&quot;PTR&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">13</span>:<span class="keyword">return</span> <span class="string">&quot;HINFO&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">15</span>:<span class="keyword">return</span> <span class="string">&quot;MX&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">28</span>:<span class="keyword">return</span> <span class="string">&quot;AAAA&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">252</span>:<span class="keyword">return</span> <span class="string">&quot;AXFR&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">255</span>:<span class="keyword">return</span> <span class="string">&quot;ANY&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tls</span></span><br><span class="line"><span class="comment">/********************** get tls protocol to check the data is meet this format or not **********************/</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">DataPackage::getisTlsProtocol</span><span class="params">(<span class="type">int</span> offset)</span></span>&#123;</span><br><span class="line">    <span class="type">char</span>*ssl;</span><br><span class="line">    ssl = (<span class="type">char</span>*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + <span class="number">20</span> + offset);</span><br><span class="line">    u_char type = (u_char)(*ssl);</span><br><span class="line">    <span class="keyword">if</span>(type &gt;= <span class="number">20</span> &amp;&amp; type &lt;= <span class="number">23</span>)&#123;</span><br><span class="line">        u_short *point = (u_short*)(ssl+<span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> version = <span class="built_in">ntohs</span>(*point);</span><br><span class="line">        <span class="keyword">if</span>(version &gt;= <span class="number">0x0301</span> &amp;&amp; version &lt;= <span class="number">0x0304</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls basic information **********************/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsBasicInfo</span><span class="params">(<span class="type">int</span> offset, u_char &amp;contentType, u_short &amp;version, u_short &amp;length)</span></span>&#123;</span><br><span class="line">    u_char*ssl;</span><br><span class="line">    ssl = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    contentType = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    u_short* pointer = (u_short*)(ssl);</span><br><span class="line">    version = <span class="built_in">ntohs</span>(*pointer);</span><br><span class="line">    pointer++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*(pointer));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/********************** get tls handshake type **********************/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsHandshakeType</span><span class="params">(<span class="type">int</span> offset, u_char &amp;type)</span></span>&#123;</span><br><span class="line">    u_char*ssl;</span><br><span class="line">    ssl = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = *ssl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls client hello information **********************/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsClientHelloInfo</span><span class="params">(<span class="type">int</span> offset, u_char &amp;handShakeType, <span class="type">int</span> &amp;length, u_short &amp;version, QString &amp;random, u_char &amp;sessionIdLength, QString &amp;sessionId,u_short&amp;cipherLength,QVector&lt;u_short&gt; &amp;cipherSuit,u_char&amp; cmLength,QVector&lt;u_char&gt;&amp;CompressionMethod,u_short&amp;extensionLength)</span></span>&#123;</span><br><span class="line">    u_char*ssl;</span><br><span class="line">    ssl = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    handShakeType = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    length = (*ssl) * <span class="number">4096</span> + (*(ssl+<span class="number">1</span>)) * <span class="number">256</span> + *(ssl + <span class="number">2</span>);</span><br><span class="line">    ssl += <span class="number">3</span>;</span><br><span class="line">    u_short* ver = (u_short*)(ssl);</span><br><span class="line">    version = <span class="built_in">ntohs</span>(*ver);</span><br><span class="line">    ver++;</span><br><span class="line">    ssl += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">32</span>;i++)&#123;</span><br><span class="line">        random += QString::<span class="built_in">number</span>(*ssl,<span class="number">16</span>);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">    sessionIdLength = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; sessionIdLength;k++)&#123;</span><br><span class="line">        sessionId += QString::<span class="built_in">number</span>(*ssl,<span class="number">16</span>);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">    u_short* clen = (u_short*)(ssl);</span><br><span class="line">    cipherLength = <span class="built_in">ntohs</span>(*clen);</span><br><span class="line">    clen++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; cipherLength/<span class="number">2</span>;k++)&#123;</span><br><span class="line">        cipherSuit.<span class="built_in">push_back</span>(<span class="built_in">ntohs</span>(*clen));</span><br><span class="line">        clen++;</span><br><span class="line">    &#125;</span><br><span class="line">    ssl += (<span class="number">2</span> + cipherLength);</span><br><span class="line">    cmLength = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k&lt;cmLength;k++)&#123;</span><br><span class="line">        CompressionMethod.<span class="built_in">push_back</span>(*ssl);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">    extensionLength = (*(ssl)) * <span class="number">256</span> + *(ssl + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsServerHelloInfo</span><span class="params">(<span class="type">int</span> offset, u_char &amp;handShakeType, <span class="type">int</span> &amp;length, u_short &amp;version, QString&amp; random, u_char &amp;sessionIdLength, QString &amp;sessionId, u_short &amp;cipherSuit, u_char &amp;compressionMethod, u_short &amp;extensionLength)</span></span>&#123;</span><br><span class="line">    u_char*ssl;</span><br><span class="line">    ssl = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    handShakeType = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    length = (*ssl) * <span class="number">4096</span> + (*(ssl + <span class="number">1</span>)) * <span class="number">256</span> + *(ssl + <span class="number">2</span>);</span><br><span class="line">    ssl += <span class="number">3</span>;</span><br><span class="line">    u_short* ver = (u_short*)(ssl);</span><br><span class="line">    version = <span class="built_in">ntohs</span>(*ver);</span><br><span class="line">    ver++;</span><br><span class="line">    ssl += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">32</span>;i++)&#123;</span><br><span class="line">        random += QString::<span class="built_in">number</span>(*ssl,<span class="number">16</span>);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">    sessionIdLength = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; sessionIdLength;k++)&#123;</span><br><span class="line">        sessionId += QString::<span class="built_in">number</span>(*ssl,<span class="number">16</span>);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">    u_short*point = (u_short*)(ssl);</span><br><span class="line">    cipherSuit = <span class="built_in">ntohs</span>(*point);</span><br><span class="line">    ssl += <span class="number">2</span>;</span><br><span class="line">    compressionMethod = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    extensionLength = (*ssl) * <span class="number">256</span> + (*(ssl + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsServerKeyExchange</span><span class="params">(<span class="type">int</span> offset, u_char &amp;handShakeType, <span class="type">int</span> &amp;length, u_char &amp;curveType, u_short &amp;curveName, u_char &amp;pubLength, QString &amp;pubKey, u_short &amp;sigAlgorithm, u_short &amp;sigLength, QString &amp;sig)</span></span>&#123;</span><br><span class="line">    u_char*ssl;</span><br><span class="line">    ssl = (u_char*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    handShakeType = *ssl;</span><br><span class="line">    ssl++;</span><br><span class="line">    length = (*ssl) * <span class="number">4096</span> + (*(ssl + <span class="number">1</span>)) * <span class="number">256</span> + *(ssl + <span class="number">2</span>);</span><br><span class="line">    ssl += <span class="number">3</span>;</span><br><span class="line">    curveType = (*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_short*point = (u_short*)(ssl);</span><br><span class="line">    curveName = <span class="built_in">ntohs</span>(*point);</span><br><span class="line">    ssl += <span class="number">2</span>;</span><br><span class="line">    pubLength = (*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; pubLength;i++)&#123;</span><br><span class="line">        pubKey += QString::<span class="built_in">number</span>(*ssl,<span class="number">16</span>);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">    point = (u_short*)(ssl);</span><br><span class="line">    sigAlgorithm = <span class="built_in">ntohs</span>(*point);</span><br><span class="line">    point++;</span><br><span class="line">    sigLength = <span class="built_in">ntohs</span>(*point);</span><br><span class="line">    ssl += <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; sigLength;i++)&#123;</span><br><span class="line">        sig += QString::<span class="built_in">number</span>(*ssl,<span class="number">16</span>);</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls handshake type **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHandshakeType</span><span class="params">(<span class="type">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="string">&quot;Client Hello&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> <span class="string">&quot;Server hello&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11</span>:<span class="keyword">return</span> <span class="string">&quot;Certificate&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">16</span>:<span class="keyword">return</span> <span class="string">&quot;Client Key Exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">return</span> <span class="string">&quot;New Session Ticket&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">12</span>:<span class="keyword">return</span> <span class="string">&quot;Server Key Exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">14</span>:<span class="keyword">return</span> <span class="string">&quot;Server Hello Done&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls content type **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsContentType</span><span class="params">(<span class="type">int</span> type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">20</span>: <span class="keyword">return</span> <span class="string">&quot;Change Cipher Spec&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">21</span>:<span class="keyword">return</span> <span class="string">&quot;Alert&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">22</span>:<span class="keyword">return</span> <span class="string">&quot;Handshake&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">23</span>:<span class="keyword">return</span> <span class="string">&quot;Application Data&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls version **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsVersion</span><span class="params">(<span class="type">int</span> version)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (version) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0300</span>:<span class="keyword">return</span> <span class="string">&quot;SSL 3.0&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0301</span>:<span class="keyword">return</span> <span class="string">&quot;TLS 1.0&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0302</span>:<span class="keyword">return</span> <span class="string">&quot;TLS 1.1&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0303</span>:<span class="keyword">return</span> <span class="string">&quot;TLS 1.2&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0304</span>:<span class="keyword">return</span> <span class="string">&quot;TLS 1.3&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;Unkonwn&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls handshake cipher suites **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHandshakeCipherSuites</span><span class="params">(u_short code)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (code) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00ff</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_EMPTY_RENEGOTIATION_INFO_SCSV (0x00ff)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc02c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xc02c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc030</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xc030)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x009f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 (0x009f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0ad</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_256_CCM (0xc0ad)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc09f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_256_CCM (0xc09f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc024</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 (0xc024)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc028</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (0xc028)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x006b</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 (0x006b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc00a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA (0xc00a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc014</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0039</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_256_CBC_SHA (0x0039)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0af</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8 (0xc0af)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a3</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_256_CCM_8 (0xc0a3)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc087</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc087)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc08b</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc08b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc07d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc07d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc073</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc073)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc077</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc077)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00c4</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 (0x00c4)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0088</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA (0x0088)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc02b</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xc02b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc02f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x009e</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_128_GCM_SHA256 (0x009e)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0ac</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_128_CCM (0xc0ac)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc09e</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_128_CCM (0xc09e)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc023</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 (0xc023)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc027</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (0xc027)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0067</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 (0x0067)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc009</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA (0xc009)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc013</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0033</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_128_CBC_SHA (0x0033)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0ae</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8 (0xc0ae)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a2</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_AES_128_CCM_8 (0xc0a2)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc086</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc086)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc08a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc08a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc07c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc07c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc072</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc072)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc076</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc076)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00be</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0x00be)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0045</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA (0x0045)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc008</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA (0xc008)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc012</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA (0xc012)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0016</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA (0x0016)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00ab</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_256_GCM_SHA384 (0x00ab)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a7</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_256_CCM (0xc0a7)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc038</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384 (0xc038)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00b3</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_256_CBC_SHA384 (0x00b3)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc036</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA (0xc036) &quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0091</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_256_CBC_SHA (0x0091)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc091</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384 (0xc091)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc09b</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc09b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc097</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc097)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0ab</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_DHE_WITH_AES_256_CCM_8 (0xc0ab)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00aa</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_128_GCM_SHA256 (0x00aa)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a6</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_128_CCM (0xc0a6)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc037</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256 (0xc037)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00b2</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_128_CBC_SHA256 (0x00b2)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc035</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA (0xc035)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0090</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_AES_128_CBC_SHA (0x0090)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc090</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256 (0xc090)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc096</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc096)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc09a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc09a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0aa</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_DHE_WITH_AES_128_CCM_8 (0xc0aa)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc034</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA (0xc034)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x008f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA (0x008f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x009d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_256_GCM_SHA384 (0x009d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc09d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_256_CCM (0xc09d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x003d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_256_CBC_SHA256 (0x003d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0035</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_256_CBC_SHA (0x0035)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc032</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384 (0xc032)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc02a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384 (0xc02a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc00f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_AES_256_CBC_SHA (0xc00f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc02e</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384 (0xc02e)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc026</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384 (0xc026)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc005</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA (0xc005)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a1</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_256_CCM_8 (0xc0a1)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc07b</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc07b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00c0</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256 (0x00c0)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0084</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_CAMELLIA_256_CBC_SHA (0x0084)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc08d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc08d)  &quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc079</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc079)  &quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc089</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 (0xc089)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc075</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 (0xc075)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x009c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_128_GCM_SHA256 (0x009c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc09c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_128_CCM (0xc09c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x003c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_128_CBC_SHA256 (0x003c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x002f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_128_CBC_SHA (0x002f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc031</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256 (0xc031)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc029</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256 (0xc029)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc00e</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_AES_128_CBC_SHA (0xc00e)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc02d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256 (0xc02d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc025</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256 (0xc025)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc004</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA (0xc004)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a0</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_AES_128_CCM_8 (0xc0a0)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc07a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc07a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00ba</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0x00ba)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0041</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_CAMELLIA_128_CBC_SHA (0x0041)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc08c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc08c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc078</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc078)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc088</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 (0xc088)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc074</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 (0xc074)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x000a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_3DES_EDE_CBC_SHA (0x000a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc00d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA (0xc00d)  &quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc003</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA (0xc003)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00ad</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 (0x00ad)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00b7</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_AES_256_CBC_SHA384 (0x00b7)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0095</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_AES_256_CBC_SHA (0x0095)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc093</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384 (0xc093)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc099</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc099)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00ac</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 (0x00ac)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00b6</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_AES_128_CBC_SHA256 (0x00b6)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0094</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_AES_128_CBC_SHA (0x0094)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc092</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256 (0xc092)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc098</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc098)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0093</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA (0x0093)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00a9</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_256_GCM_SHA384 (0x00a9)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a5</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_256_CCM (0xc0a5)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00af</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_256_CBC_SHA384 (0x00af)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x008d</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_256_CBC_SHA (0x008d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc08f</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384 (0xc08f)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc095</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384 (0xc095)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a9</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_256_CCM_8 (0xc0a9)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00a8</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_128_GCM_SHA256 (0x00a8)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a4</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_128_CCM (0xc0a4)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x00ae</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_128_CBC_SHA256 (0x00ae)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x008c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_128_CBC_SHA (0x008c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc08e</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256 (0xc08e)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc094</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256 (0xc094)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc0a8</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_AES_128_CCM_8 (0xc0a8)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x008b</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_3DES_EDE_CBC_SHA (0x008b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc007</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_RC4_128_SHA (0xc007)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc011</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_RC4_128_SHA (0xc011)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc033</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_PSK_WITH_RC4_128_SHA (0xc033)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x008e</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_PSK_WITH_RC4_128_SHA (0x008e) &quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0005</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_RC4_128_SHA (0x0005)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0004</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_WITH_RC4_128_MD5 (0x0004)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc00c</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_RSA_WITH_RC4_128_SHA (0xc00c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xc002</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDH_ECDSA_WITH_RC4_128_SHA (0xc002) &quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0092</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_RSA_PSK_WITH_RC4_128_SHA (0x0092)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x008a</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_PSK_WITH_RC4_128_SHA (0x008a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x1302</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_AES_256_GCM_SHA384 (0x1302)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x1303</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_CHACHA20_POLY1305_SHA256 (0x1303)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x1301</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_AES_128_GCM_SHA256 (0x1301)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xcca9</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 (0xcca9)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xcca8</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (0xcca8)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0xccaa</span>: <span class="keyword">return</span> <span class="string">&quot;TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256 (0xccaa)&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;0x&quot;</span> + QString::<span class="built_in">number</span>(code,<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/********************** get tls handshake compression **********************/</span></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHandshakeCompression</span><span class="params">(u_char code)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (code) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">return</span> <span class="string">&quot;null&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHandshakeExtension</span><span class="params">(u_short type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">return</span> <span class="string">&quot;server_name&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>: <span class="keyword">return</span> <span class="string">&quot;status_request&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11</span>:<span class="keyword">return</span> <span class="string">&quot;ec_point_format&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">10</span>:<span class="keyword">return</span> <span class="string">&quot;supported_groups&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">35</span>:<span class="keyword">return</span> <span class="string">&quot;session_ticket&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">22</span>:<span class="keyword">return</span> <span class="string">&quot;encrypt_then_mac&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">23</span>:<span class="keyword">return</span> <span class="string">&quot;extended_master_secret&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">13</span>:<span class="keyword">return</span> <span class="string">&quot;signature_algorithms&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">43</span>:<span class="keyword">return</span> <span class="string">&quot;supported_versions&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">45</span>:<span class="keyword">return</span> <span class="string">&quot;psk_key_exchange_modes&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">51</span>:<span class="keyword">return</span> <span class="string">&quot;key_share&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">21</span>:<span class="keyword">return</span> <span class="string">&quot;padding&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">18</span>:<span class="keyword">return</span> <span class="string">&quot;signed_certificate_timestamp&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">39578</span>:<span class="keyword">return</span> <span class="string">&quot;Reserved (GREASE) (39578)&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;Unknown type&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHandshakeExtensionECPointFormat</span><span class="params">(u_char type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">return</span> <span class="string">&quot;EC point format: uncompressed (0)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="string">&quot;EC point format: ansiX962_compressed_prime (1)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> <span class="string">&quot;EC point format: ansiX962_compressed_char2 (2)&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> QString::<span class="built_in">number</span>(type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHandshakeExtensionSupportGroup</span><span class="params">(u_short type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x001d</span>:<span class="keyword">return</span> <span class="string">&quot;x25519 (0x001d)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0017</span>:<span class="keyword">return</span> <span class="string">&quot;secp256r1 (0x0017)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x001e</span>:<span class="keyword">return</span> <span class="string">&quot;x448 (0x001e)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0019</span>:<span class="keyword">return</span> <span class="string">&quot;secp521r1 (0x0019)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0018</span>:<span class="keyword">return</span> <span class="string">&quot;secp384r1 (0x0018)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x001c</span>:<span class="keyword">return</span> <span class="string">&quot;brainpoolP512r1 (0x001c)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x001b</span>:<span class="keyword">return</span> <span class="string">&quot;brainpoolP384r1 (0x001b)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0016</span>:<span class="keyword">return</span> <span class="string">&quot;secp256k1 (0x0016)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x001a</span>:<span class="keyword">return</span> <span class="string">&quot;brainpoolP256r1 (0x001a)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0015</span>:<span class="keyword">return</span> <span class="string">&quot;secp224r1 (0x0015)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0014</span>:<span class="keyword">return</span> <span class="string">&quot;secp224k1 (0x0014)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0013</span>:<span class="keyword">return</span> <span class="string">&quot;secp192r1 (0x0013)&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0x0012</span>:<span class="keyword">return</span> <span class="string">&quot;secp192k1 (0x0012)&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;0x&quot;</span> + QString::<span class="built_in">number</span>(type,<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHadshakeExtensionHash</span><span class="params">(u_char type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">return</span> <span class="string">&quot;SHA256&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:<span class="keyword">return</span> <span class="string">&quot;SHA384&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">return</span> <span class="string">&quot;SHA512&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> <span class="string">&quot;SHA1&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">return</span> <span class="string">&quot;SHA224&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="string">&quot;MD5&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">QString <span class="title">DataPackage::getTlsHadshakeExtensionSignature</span><span class="params">(u_char type)</span></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="string">&quot;RSA&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:<span class="keyword">return</span> <span class="string">&quot;DSA&quot;</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">return</span> <span class="string">&quot;ECDSA&quot;</span>;</span><br><span class="line">    <span class="keyword">default</span>:<span class="keyword">return</span> <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">u_short <span class="title">DataPackage::getTlsExtensionType</span><span class="params">(<span class="type">int</span> offset)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionServerName</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length, u_short &amp;listLength, u_char &amp;nameType, u_short &amp;nameLength, QString &amp;name)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    listLength = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_char*p = (u_char*)ssl;</span><br><span class="line">    nameType = *p;</span><br><span class="line">    p++;</span><br><span class="line">    nameLength = (*p) * <span class="number">16</span> + *(p+<span class="number">1</span>);</span><br><span class="line">    p += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; nameLength;i++)&#123;</span><br><span class="line">        name += (*p);</span><br><span class="line">        p++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionKeyShare</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length, u_short &amp;shareLength, u_short &amp;group, u_short &amp;exchangeLength,QString &amp;exchange)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    shareLength = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    group = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    exchangeLength = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_char*point = (u_char*)(ssl);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; exchangeLength;i++)&#123;</span><br><span class="line">        exchange += QString::<span class="built_in">number</span>(*point,<span class="number">16</span>);</span><br><span class="line">        point++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionEcPointFormats</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length,u_char&amp; ecLength,QVector&lt;u_char&gt; &amp;EC)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_char* point = (u_char*)(ssl);</span><br><span class="line">    ecLength = *point;</span><br><span class="line">    point++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; ecLength;i++)&#123;</span><br><span class="line">        EC.<span class="built_in">push_back</span>(*point);</span><br><span class="line">        point++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionOther</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length,QString&amp;data)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_char*point = (u_char*)(ssl);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; length;i++)&#123;</span><br><span class="line">        data += QString::<span class="built_in">number</span>(*point,<span class="number">16</span>);</span><br><span class="line">        point++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionSupportGroups</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length, u_short &amp;groupListLength, QVector&lt;u_short&gt; &amp;group)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    groupListLength = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; groupListLength/<span class="number">2</span>;i++)&#123;</span><br><span class="line">        group.<span class="built_in">push_back</span>(<span class="built_in">ntohs</span>(*ssl));</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionSessionTicket</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionEncryptThenMac</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionExtendMasterSecret</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionSignatureAlgorithms</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length, u_short &amp;algorithmLength, QVector&lt;u_short&gt; &amp;signatureAlgorithm)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    algorithmLength = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; algorithmLength/<span class="number">2</span>;i++)&#123;</span><br><span class="line">        signatureAlgorithm.<span class="built_in">push_back</span>(<span class="built_in">ntohs</span>(*ssl));</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionSupportVersions</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length, u_char &amp;supportLength, QVector&lt;u_short&gt; &amp;supportVersion)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_char*point = (u_char*)(ssl);</span><br><span class="line">    supportLength = *point;</span><br><span class="line">    point++;</span><br><span class="line">    ssl = (u_short*)(point);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; supportLength;i++)&#123;</span><br><span class="line">        supportVersion.<span class="built_in">push_back</span>(<span class="built_in">ntohs</span>(*ssl));</span><br><span class="line">        ssl++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DataPackage::getTlsExtensionPadding</span><span class="params">(<span class="type">int</span> offset, u_short &amp;type, u_short &amp;length,QString&amp; data)</span></span>&#123;</span><br><span class="line">    u_short*ssl;</span><br><span class="line">    ssl = (u_short*)(pkt_content + <span class="number">14</span> + <span class="number">20</span> + offset);</span><br><span class="line">    type = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    length = <span class="built_in">ntohs</span>(*ssl);</span><br><span class="line">    ssl++;</span><br><span class="line">    u_char*point = (u_char*)(ssl);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; length;i++)&#123;</span><br><span class="line">        data += QString::<span class="built_in">number</span>(*point,<span class="number">16</span>);</span><br><span class="line">        point++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>6、Format.h</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> FORMAT_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FORMAT_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   @ This head file is used to define format of packages</span></span><br><span class="line"><span class="comment">   @ auther DJH-sudo</span></span><br><span class="line"><span class="comment">   @ if you have any question,pls contact me at djh113@126.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// define some types and macro defination</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span> u_char;     <span class="comment">// 1 byte</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">short</span> u_short;   <span class="comment">// 2 byte</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span> u_int;       <span class="comment">// 4 byte</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> u_long;     <span class="comment">// 4 byte</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ARP  <span class="string">&quot;ARP&quot;</span>                 <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TCP  <span class="string">&quot;TCP&quot;</span>                 <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UDP  <span class="string">&quot;UDP&quot;</span>                 <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ICMP <span class="string">&quot;ICMP&quot;</span>                <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DNS  <span class="string">&quot;DNS&quot;</span>                 <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TLS  <span class="string">&quot;TLS&quot;</span>                 <span class="comment">//</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SSL  <span class="string">&quot;SSL&quot;</span>                 <span class="comment">//</span></span></span><br><span class="line"><span class="comment">// Ethernet protocol format</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+-------------------+-----------------+------+</span></span><br><span class="line"><span class="comment">|       6 byte      |     6 byte      |2 byte|</span></span><br><span class="line"><span class="comment">+-------------------+-----------------+------+</span></span><br><span class="line"><span class="comment">|destination address|  source address | type |</span></span><br><span class="line"><span class="comment">+-------------------+-----------------+------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">ether_header</span>&#123;   <span class="comment">// 14 byte</span></span><br><span class="line">    u_char ether_des_host[<span class="number">6</span>];  <span class="comment">// destination addr [6 byte]</span></span><br><span class="line">    u_char ether_src_host[<span class="number">6</span>];  <span class="comment">// source addr [6 byte]</span></span><br><span class="line">    u_short ether_type;        <span class="comment">// type [2 byte]</span></span><br><span class="line">&#125;ETHER_HEADER;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Ipv4 header</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+-------+-----------+---------------+-------------------------+</span></span><br><span class="line"><span class="comment">| 4 bit |   4 bit   |    8 bit      |          16 bit         |</span></span><br><span class="line"><span class="comment">+-------+-----------+---------------+-------------------------+</span></span><br><span class="line"><span class="comment">|version|head length|  TOS/DS_byte  |        total length     |</span></span><br><span class="line"><span class="comment">+-------------------+--+---+---+----+-+-+-+-------------------+</span></span><br><span class="line"><span class="comment">|          identification           |R|D|M|    offset         |</span></span><br><span class="line"><span class="comment">+-------------------+---------------+-+-+-+-------------------+</span></span><br><span class="line"><span class="comment">|       ttl         |     protocal  |         checksum        |</span></span><br><span class="line"><span class="comment">+-------------------+---------------+-------------------------+</span></span><br><span class="line"><span class="comment">|                   source ip address                         |</span></span><br><span class="line"><span class="comment">+-------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">|                 destination ip address                      |</span></span><br><span class="line"><span class="comment">+-------------------------------------------------------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">ip_header</span>&#123;           <span class="comment">// 20 byte</span></span><br><span class="line">    u_char versiosn_head_length;    <span class="comment">// version [4 bit] and length of header [4 bit]</span></span><br><span class="line">    u_char TOS;                     <span class="comment">// TOS/DS_byte [1 byte]</span></span><br><span class="line">    u_short total_length;           <span class="comment">// ip package total length [2 byte]</span></span><br><span class="line">    u_short identification;         <span class="comment">// identification [2 byte]</span></span><br><span class="line">    u_short flag_offset;            <span class="comment">// flag [3 bit] and offset [13 bit]</span></span><br><span class="line">    u_char ttl;                     <span class="comment">// TTL [1 byte]</span></span><br><span class="line">    u_char protocol;                <span class="comment">// protocal [1 byte]</span></span><br><span class="line">    u_short checksum;               <span class="comment">// checksum [2 byte]</span></span><br><span class="line">    u_int src_addr;                 <span class="comment">// source address [4 byte]</span></span><br><span class="line">    u_int des_addr;                 <span class="comment">// destination address [4 byte]</span></span><br><span class="line">&#125;IP_HEADER;</span><br><span class="line"><span class="comment">// Tcp header</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+----------------------+---------------------+</span></span><br><span class="line"><span class="comment">|         16 bit       |       16 bit        |</span></span><br><span class="line"><span class="comment">+----------------------+---------------------+</span></span><br><span class="line"><span class="comment">|      source port     |  destination port   |</span></span><br><span class="line"><span class="comment">+----------------------+---------------------+</span></span><br><span class="line"><span class="comment">|              sequence number               |</span></span><br><span class="line"><span class="comment">+----------------------+---------------------+</span></span><br><span class="line"><span class="comment">|                 ack number                 |</span></span><br><span class="line"><span class="comment">+----+---------+-------+---------------------+</span></span><br><span class="line"><span class="comment">|head| reserve | flags |     window size     |</span></span><br><span class="line"><span class="comment">+----+---------+-------+---------------------+</span></span><br><span class="line"><span class="comment">|     checksum         |   urgent pointer    |</span></span><br><span class="line"><span class="comment">+----------------------+---------------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">tcp_header</span>&#123;    <span class="comment">// 20 byte</span></span><br><span class="line">    u_short src_port;         <span class="comment">// source port [2 byte]</span></span><br><span class="line">    u_short des_port;         <span class="comment">// destination [2 byte]</span></span><br><span class="line">    u_int sequence;           <span class="comment">// sequence number [4 byte]</span></span><br><span class="line">    u_int ack;                <span class="comment">// Confirm serial number [4 byte]</span></span><br><span class="line">    u_char header_length;     <span class="comment">// header length [4 bit]</span></span><br><span class="line">    u_char flags;             <span class="comment">// flags [6 bit]</span></span><br><span class="line">    u_short window_size;      <span class="comment">// size of window [2 byte]</span></span><br><span class="line">    u_short checksum;         <span class="comment">// checksum [2 byte]</span></span><br><span class="line">    u_short urgent;           <span class="comment">// urgent pointer [2 byte]</span></span><br><span class="line">&#125;TCP_HEADER;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Udp header</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">|        16 bit       |        16 bit       |</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">|    source port      |   destination port  |</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">| data package length |       checksum      |</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">udp_header</span>&#123; <span class="comment">// 8 byte</span></span><br><span class="line">    u_short src_port;      <span class="comment">// source port [2 byte]</span></span><br><span class="line">    u_short des_port;      <span class="comment">// destination port [2 byte]</span></span><br><span class="line">    u_short data_length;   <span class="comment">// data length [2 byte]</span></span><br><span class="line">    u_short checksum;      <span class="comment">// checksum [2 byte]</span></span><br><span class="line"></span><br><span class="line">&#125;UDP_HEADER;</span><br><span class="line"><span class="comment">// Icmp header</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">|  1 byte  |  1 byte  |        2 byte       |</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">|   type   |   code   |       checksum      |</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">|    identification   |       sequence      |</span></span><br><span class="line"><span class="comment">+---------------------+---------------------+</span></span><br><span class="line"><span class="comment">|                  option                   |</span></span><br><span class="line"><span class="comment">+-------------------------------------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">icmp_header</span>&#123;         <span class="comment">// at least 8 byte</span></span><br><span class="line">    u_char type;                    <span class="comment">// type [1 byte]</span></span><br><span class="line">    u_char code;                    <span class="comment">// code [1 byte]</span></span><br><span class="line">    u_short checksum;               <span class="comment">// checksum [2 byte]</span></span><br><span class="line">    u_short identification;         <span class="comment">// identification [2 byte]</span></span><br><span class="line">    u_short sequence;               <span class="comment">// sequence [2 byte]</span></span><br><span class="line">&#125;ICMP_HEADER;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Arp</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">|&lt;--------  ARP header  ------------&gt;|</span></span><br><span class="line"><span class="comment">+------+--------+-----+------+-------+----------+---------+---------------+--------------+</span></span><br><span class="line"><span class="comment">|2 byte| 2 byte |1byte| 1byte|2 byte |  6 byte  | 4 byte  |     6 byte    |     4 byte   |</span></span><br><span class="line"><span class="comment">+------+--------+-----+------+-------+----------+---------+---------------+--------------+</span></span><br><span class="line"><span class="comment">| type |protocol|e_len|ip_len|op_type|source mac|source ip|destination mac|destination ip|</span></span><br><span class="line"><span class="comment">+------+--------+-----+------+-------+----------+---------+---------------+--------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">arp_header</span>&#123;   <span class="comment">// 28 byte</span></span><br><span class="line">    u_short hardware_type;   <span class="comment">// hardware type [2 byte]</span></span><br><span class="line">    u_short protocol_type;   <span class="comment">// protocol [2 byte]</span></span><br><span class="line">    u_char mac_length;       <span class="comment">// MAC address length [1 byte]</span></span><br><span class="line">    u_char ip_length;        <span class="comment">// IP address length [1 byte]</span></span><br><span class="line">    u_short op_code;         <span class="comment">// operation code [2 byte]</span></span><br><span class="line"></span><br><span class="line">    u_char src_eth_addr[<span class="number">6</span>];  <span class="comment">// source ether address [6 byte]</span></span><br><span class="line">    u_char src_ip_addr[<span class="number">4</span>];   <span class="comment">// source ip address [4 byte]</span></span><br><span class="line">    u_char des_eth_addr[<span class="number">6</span>];  <span class="comment">// destination ether address [6 byte]</span></span><br><span class="line">    u_char des_ip_addr[<span class="number">4</span>];   <span class="comment">// destination ip address [4 byte]</span></span><br><span class="line"></span><br><span class="line">&#125;ARP_HEADER;</span><br><span class="line"><span class="comment">// dns</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">+--------------------------+---------------------------+</span></span><br><span class="line"><span class="comment">|           16 bit         |1b|4bit|1b|1b|1b|1b|3b|4bit|</span></span><br><span class="line"><span class="comment">+--------------------------+--+----+--+--+--+--+--+----+</span></span><br><span class="line"><span class="comment">|      identification      |QR| OP |AA|TC|RD|RA|..|Resp|</span></span><br><span class="line"><span class="comment">+--------------------------+--+----+--+--+--+--+--+----+</span></span><br><span class="line"><span class="comment">|         Question         |       Answer RRs          |</span></span><br><span class="line"><span class="comment">+--------------------------+---------------------------+</span></span><br><span class="line"><span class="comment">|     Authority RRs        |      Additional RRs       |</span></span><br><span class="line"><span class="comment">+--------------------------+---------------------------+</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">dns_header</span>&#123;  <span class="comment">// 12 byte</span></span><br><span class="line">    u_short identification; <span class="comment">// Identification [2 byte]</span></span><br><span class="line">    u_short flags;          <span class="comment">// Flags [total 2 byte]</span></span><br><span class="line">    u_short question;       <span class="comment">// Question Number [2 byte]</span></span><br><span class="line">    u_short answer;         <span class="comment">// Answer RRs [2 byte]</span></span><br><span class="line">    u_short authority;      <span class="comment">// Authority RRs [2 byte]</span></span><br><span class="line">    u_short additional;     <span class="comment">// Additional RRs [2 byte]</span></span><br><span class="line">&#125;DNS_HEADER;</span><br><span class="line"></span><br><span class="line"><span class="comment">// dns question</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">dns_question</span>&#123;</span><br><span class="line">    <span class="comment">// char* name;          // Non-fixed</span></span><br><span class="line">    u_short query_type;     <span class="comment">// 2 byte</span></span><br><span class="line">    u_short query_class;    <span class="comment">// 2 byte</span></span><br><span class="line">&#125;DNS_QUESITON;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">dns_answer</span>&#123;</span><br><span class="line">    <span class="comment">// char* name          // Non-fixed</span></span><br><span class="line">    u_short answer_type;   <span class="comment">// 2 byte</span></span><br><span class="line">    u_short answer_class;  <span class="comment">// 2 byte</span></span><br><span class="line">    u_int TTL;             <span class="comment">// 4 byte</span></span><br><span class="line">    u_short dataLength;    <span class="comment">// 2 byte</span></span><br><span class="line">    <span class="comment">//char* name           // Non-fixed</span></span><br><span class="line">&#125;DNS_ANSWER;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// FORMAT_H</span></span></span><br></pre></td></tr></table></figure>

<p>7、mainwindow.h</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAINWINDOW_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMainWindow&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pcap.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(lib,<span class="string">&quot;ws2_32.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;capture.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;readonlydelegate.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QVector&gt;</span></span></span><br><span class="line"></span><br><span class="line">QT_BEGIN_NAMESPACE</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123; <span class="keyword">class</span> <span class="title class_">MainWindow</span>; &#125;</span><br><span class="line">QT_END_NAMESPACE</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainWindow</span> : <span class="keyword">public</span> QMainWindow</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// construction and destruction</span></span><br><span class="line">    <span class="built_in">MainWindow</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">MainWindow</span>();</span><br><span class="line">    <span class="comment">// show network card</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">showNetworkCard</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">// capture the data package</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">capture</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">on_comboBox_currentIndexChanged</span><span class="params">(<span class="type">int</span> index)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">on_tableWidget_cellClicked</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> column)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">on_lineEdit_returnPressed</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">on_lineEdit_textChanged</span><span class="params">(<span class="type">const</span> QString &amp;arg1)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">on_tableWidget_currentCellChanged</span><span class="params">(<span class="type">int</span> currentRow, <span class="type">int</span> currentColumn, <span class="type">int</span> previousRow, <span class="type">int</span> previousColumn)</span></span>;</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">handleMessage</span><span class="params">(DataPackage data)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MainWindow *ui;</span><br><span class="line">    <span class="type">pcap_if_t</span> *all_devices;                 <span class="comment">// all adapter device</span></span><br><span class="line">    <span class="type">pcap_if_t</span> *device;                      <span class="comment">// An adapter</span></span><br><span class="line">    <span class="type">pcap_t</span> *pointer;                        <span class="comment">// data package pointer</span></span><br><span class="line">    ReadOnlyDelegate* readOnlyDelegate;     <span class="comment">// readonly detegate</span></span><br><span class="line">    <span class="type">int</span> countNumber;                        <span class="comment">// countNumber</span></span><br><span class="line">    <span class="type">int</span> rowNumber;                          <span class="comment">// rowNumber</span></span><br><span class="line">    QVector&lt;DataPackage&gt;data;               <span class="comment">// store data</span></span><br><span class="line">    <span class="type">char</span> errbuf[PCAP_ERRBUF_SIZE];          <span class="comment">// error buffer</span></span><br><span class="line">    <span class="type">bool</span> isStart;                           <span class="comment">// the thread is start or not</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>

<p>8、mainwindow.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ui_mainwindow.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;pcap.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;winsock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;capture.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStringList&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QColor&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QTreeWidgetItem&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QStringList&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * MainWindow</span></span><br><span class="line"><span class="comment"> * Constructure function</span></span><br><span class="line"><span class="comment"> * initialize the variables and GUI</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">MainWindow::<span class="built_in">MainWindow</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QMainWindow</span>(parent)</span><br><span class="line">    , <span class="built_in">ui</span>(<span class="keyword">new</span> Ui::MainWindow)</span><br><span class="line">&#123;</span><br><span class="line">    ui-&gt;<span class="built_in">setupUi</span>(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">statusBar</span>()-&gt;<span class="built_in">showMessage</span>(<span class="string">&quot;welcome to shark!&quot;</span>);</span><br><span class="line">    <span class="comment">// set the toolbar</span></span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actionstart_capture);</span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actionclear_all);</span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actionup);</span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actiondown);</span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actionTop);</span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">addAction</span>(ui-&gt;actionEnd);</span><br><span class="line">    <span class="comment">// show network card</span></span><br><span class="line">    <span class="built_in">showNetworkCard</span>();</span><br><span class="line">    <span class="comment">// initialization</span></span><br><span class="line">    Capture *thread = <span class="keyword">new</span> Capture;</span><br><span class="line">    ui-&gt;comboBox-&gt;<span class="built_in">setEnabled</span>(<span class="literal">true</span>);</span><br><span class="line">    isStart = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">static</span> <span class="type">bool</span> index = <span class="literal">false</span>;</span><br><span class="line">    countNumber = <span class="number">0</span>;</span><br><span class="line">    rowNumber = <span class="number">-1</span>;</span><br><span class="line">    data.<span class="built_in">clear</span>();</span><br><span class="line">    device = <span class="literal">nullptr</span>;</span><br><span class="line">    pointer = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add the signal-slot</span></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actionstart_capture,&amp;QAction::triggered,<span class="keyword">this</span>,[=]&#123;</span><br><span class="line">        index = !index;</span><br><span class="line">        <span class="keyword">if</span>(index)&#123;</span><br><span class="line">            <span class="keyword">if</span>(ui-&gt;tableWidget-&gt;<span class="built_in">rowCount</span>())&#123;</span><br><span class="line">                <span class="type">int</span> type = QMessageBox::<span class="built_in">information</span>(<span class="literal">NULL</span>,<span class="string">&quot;information&quot;</span>,<span class="string">&quot;Before restarting do you want to save result?&quot;</span>,<span class="string">&quot;Save&quot;</span>,<span class="string">&quot;Continue&quot;</span>,<span class="string">&quot;Cancel&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(type == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// save the file...</span></span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;not save&quot;</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    index = !index;</span><br><span class="line">                    isStart = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ui-&gt;tableWidget-&gt;<span class="built_in">clearContents</span>();</span><br><span class="line">            ui-&gt;tableWidget-&gt;<span class="built_in">setRowCount</span>(<span class="number">0</span>);</span><br><span class="line">            ui-&gt;treeWidget-&gt;<span class="built_in">clear</span>();</span><br><span class="line">            countNumber = <span class="number">0</span>;</span><br><span class="line">            rowNumber = <span class="number">-1</span>;</span><br><span class="line">            <span class="type">int</span> dataSize = <span class="keyword">this</span>-&gt;data.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; dataSize;i++)&#123;</span><br><span class="line">                <span class="built_in">free</span>((<span class="type">char</span>*)(<span class="keyword">this</span>-&gt;data[i].pkt_content));</span><br><span class="line">                <span class="keyword">this</span>-&gt;data[i].pkt_content = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">QVector</span>&lt;DataPackage&gt;().<span class="built_in">swap</span>(data);</span><br><span class="line">            <span class="type">int</span> res = <span class="built_in">capture</span>();</span><br><span class="line">            <span class="keyword">if</span>(pointer &amp;&amp; res != <span class="number">-1</span>)&#123;</span><br><span class="line">                thread-&gt;<span class="built_in">resetFlag</span>();</span><br><span class="line">                thread-&gt;<span class="built_in">setPointer</span>(pointer);</span><br><span class="line">                ui-&gt;comboBox-&gt;<span class="built_in">setEnabled</span>(<span class="literal">false</span>);</span><br><span class="line">                thread-&gt;<span class="built_in">start</span>();</span><br><span class="line">                ui-&gt;actionstart_capture-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;:/stop.png&quot;</span>));</span><br><span class="line">                countNumber = <span class="number">0</span>;</span><br><span class="line">                isStart = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123; <span class="comment">// fail to start</span></span><br><span class="line">                index = !index;</span><br><span class="line">                countNumber = <span class="number">0</span>;</span><br><span class="line">                rowNumber = <span class="number">-1</span>;</span><br><span class="line">                isStart = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            thread-&gt;<span class="built_in">setFlag</span>();</span><br><span class="line">            ui-&gt;comboBox-&gt;<span class="built_in">setEnabled</span>(<span class="literal">true</span>);</span><br><span class="line">            thread-&gt;<span class="built_in">quit</span>();</span><br><span class="line">            thread-&gt;<span class="built_in">wait</span>();</span><br><span class="line">            <span class="built_in">pcap_close</span>(pointer);</span><br><span class="line">            ui-&gt;actionstart_capture-&gt;<span class="built_in">setIcon</span>(<span class="built_in">QIcon</span>(<span class="string">&quot;:/start.png&quot;</span>));</span><br><span class="line">            isStart = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actionclear_all,&amp;QAction::triggered,<span class="keyword">this</span>,[=]&#123;</span><br><span class="line">        <span class="keyword">if</span>(!isStart)&#123;</span><br><span class="line">            <span class="type">int</span> type = QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;information&quot;</span>,<span class="string">&quot;Do you want to clear all?&quot;</span>,<span class="string">&quot;Yes&quot;</span>,<span class="string">&quot;Cancel&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(type == <span class="number">0</span>)&#123;</span><br><span class="line">                ui-&gt;tableWidget-&gt;<span class="built_in">clearContents</span>();</span><br><span class="line">                ui-&gt;tableWidget-&gt;<span class="built_in">setRowCount</span>(<span class="number">0</span>);</span><br><span class="line">                ui-&gt;treeWidget-&gt;<span class="built_in">clear</span>();</span><br><span class="line">                countNumber = <span class="number">0</span>;</span><br><span class="line">                rowNumber = <span class="number">-1</span>;</span><br><span class="line">                <span class="type">int</span> dataSize = <span class="keyword">this</span>-&gt;data.<span class="built_in">size</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; dataSize;i++)&#123;</span><br><span class="line">                    <span class="built_in">free</span>((<span class="type">char</span>*)(<span class="keyword">this</span>-&gt;data[i].pkt_content));</span><br><span class="line">                    <span class="keyword">this</span>-&gt;data[i].pkt_content = <span class="literal">nullptr</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">QVector</span>&lt;DataPackage&gt;().<span class="built_in">swap</span>(data);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actionup,&amp;QAction::triggered,<span class="keyword">this</span>,[=]&#123;</span><br><span class="line">        <span class="type">int</span> index = ui-&gt;tableWidget-&gt;<span class="built_in">currentRow</span>();</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ui-&gt;tableWidget-&gt;<span class="built_in">setCurrentCell</span>(index - <span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="built_in">on_tableWidget_cellClicked</span>(index - <span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actiondown,&amp;QAction::triggered,<span class="keyword">this</span>,[=]&#123;</span><br><span class="line">        <span class="type">int</span> index = ui-&gt;tableWidget-&gt;<span class="built_in">currentRow</span>();</span><br><span class="line">        <span class="keyword">if</span>(index &gt;= <span class="number">0</span> &amp;&amp; index &lt; ui-&gt;tableWidget-&gt;<span class="built_in">rowCount</span>() - <span class="number">1</span>)&#123;</span><br><span class="line">            ui-&gt;tableWidget-&gt;<span class="built_in">setCurrentCell</span>(index + <span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="built_in">on_tableWidget_cellClicked</span>(index + <span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actionTop,&amp;QAction::triggered,<span class="keyword">this</span>,[=]&#123;</span><br><span class="line">        <span class="type">int</span> index = ui-&gt;tableWidget-&gt;<span class="built_in">currentRow</span>();</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ui-&gt;tableWidget-&gt;<span class="built_in">setCurrentCell</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">            <span class="built_in">on_tableWidget_cellClicked</span>(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(ui-&gt;actionEnd,&amp;QAction::triggered,<span class="keyword">this</span>,[=]&#123;</span><br><span class="line">        <span class="type">int</span> index = ui-&gt;tableWidget-&gt;<span class="built_in">rowCount</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(index &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            ui-&gt;tableWidget-&gt;<span class="built_in">setCurrentCell</span>(index,<span class="number">0</span>);</span><br><span class="line">            <span class="built_in">on_tableWidget_cellClicked</span>(index,<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">connect</span>(thread,&amp;Capture::send,<span class="keyword">this</span>,&amp;MainWindow::handleMessage);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// initialization</span></span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setShowGrid</span>(<span class="literal">false</span>);</span><br><span class="line">    ui-&gt;toolBar-&gt;<span class="built_in">setMovable</span>(<span class="literal">false</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">verticalHeader</span>()-&gt;<span class="built_in">setVisible</span>(<span class="literal">false</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnCount</span>(<span class="number">7</span>);</span><br><span class="line">    readOnlyDelegate = <span class="keyword">new</span> <span class="built_in">ReadOnlyDelegate</span>();</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItemDelegate</span>(readOnlyDelegate);</span><br><span class="line">    QStringList title = &#123;<span class="string">&quot;NO.&quot;</span>,<span class="string">&quot;Time&quot;</span>,<span class="string">&quot;Source&quot;</span>,<span class="string">&quot;Destination&quot;</span>,<span class="string">&quot;Protocol&quot;</span>,<span class="string">&quot;Length&quot;</span>,<span class="string">&quot;Info&quot;</span>&#125;;</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setHorizontalHeaderLabels</span>(title);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">verticalHeader</span>()-&gt;<span class="built_in">setDefaultSectionSize</span>(<span class="number">30</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">0</span>,<span class="number">50</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">1</span>,<span class="number">150</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">2</span>,<span class="number">300</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">3</span>,<span class="number">300</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">4</span>,<span class="number">100</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">5</span>,<span class="number">100</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setColumnWidth</span>(<span class="number">6</span>,<span class="number">1000</span>);</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setSelectionBehavior</span>(QAbstractItemView::SelectRows);</span><br><span class="line">    ui-&gt;treeWidget-&gt;<span class="built_in">setHeaderHidden</span>(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ~MainWindow</span></span><br><span class="line"><span class="comment"> * Destructure function</span></span><br><span class="line"><span class="comment"> * free memory</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">MainWindow::~<span class="built_in">MainWindow</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// free the memory you have allocated!</span></span><br><span class="line">    <span class="type">int</span> dataSize = <span class="keyword">this</span>-&gt;data.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;dataSize;i++)&#123;</span><br><span class="line">        <span class="built_in">free</span>((<span class="type">char</span>*)(<span class="keyword">this</span>-&gt;data[i].pkt_content));</span><br><span class="line">        <span class="keyword">this</span>-&gt;data[i].pkt_content = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// do not use &#x27;data.clear()&#x27; only,it can&#x27;t free totally!</span></span><br><span class="line">    <span class="built_in">QVector</span>&lt;DataPackage&gt;().<span class="built_in">swap</span>(data);</span><br><span class="line">    <span class="keyword">delete</span> readOnlyDelegate;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * showNetworkCard</span></span><br><span class="line"><span class="comment"> * scan the network cards and show information about it at combox</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::showNetworkCard</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">pcap_findalldevs</span>(&amp;all_devices,errbuf);</span><br><span class="line">    ui-&gt;comboBox-&gt;<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="built_in">statusBar</span>()-&gt;<span class="built_in">showMessage</span>(<span class="string">&quot;There is something wrong&quot;</span> + <span class="built_in">QString</span>(errbuf));</span><br><span class="line">        ui-&gt;comboBox-&gt;<span class="built_in">addItem</span>(<span class="string">&quot;Cannot find a matching network card, please restart and test&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ui-&gt;comboBox-&gt;<span class="built_in">clear</span>();</span><br><span class="line">    ui-&gt;comboBox-&gt;<span class="built_in">addItem</span>(<span class="string">&quot;please chose the Network Card!&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(device = all_devices;device!= <span class="literal">nullptr</span>;device = device-&gt;next)&#123;</span><br><span class="line">        QString device_name = device-&gt;name;</span><br><span class="line">        device_name.<span class="built_in">replace</span>(<span class="string">&quot;\\Device\\&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        QString device_description = device-&gt;description;</span><br><span class="line">        QString item = device_name + <span class="string">&quot;   &quot;</span> + device_description;</span><br><span class="line">        ui-&gt;comboBox-&gt;<span class="built_in">addItem</span>(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * on_comboBox_currentIndexChanged</span></span><br><span class="line"><span class="comment"> * when item of combox changed,the device pointer will also change</span></span><br><span class="line"><span class="comment"> * this function could ensure device pointer point to the selected network card</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_comboBox_currentIndexChanged</span><span class="params">(<span class="type">int</span> index)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(index!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(device = all_devices;i&lt;index - <span class="number">1</span>;i++,device = device-&gt;next);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        device = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * capture</span></span><br><span class="line"><span class="comment"> * starting capture the data package from card</span></span><br><span class="line"><span class="comment"> * the data package in data link layer must meet the IEEE 802.3 protocol</span></span><br><span class="line"><span class="comment"> * or it will be throwed away</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">MainWindow::capture</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// pcap_t * pcap_open_live(char*device,int snaplen,int promisc,int to_ms,char*errbuf);</span></span><br><span class="line">    <span class="keyword">if</span>(device)</span><br><span class="line">        pointer = <span class="built_in">pcap_open_live</span>(device-&gt;name,<span class="number">65536</span>,<span class="number">1</span>,<span class="number">1000</span>,errbuf);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">statusBar</span>()-&gt;<span class="built_in">showMessage</span>(<span class="string">&quot;pls choose Network Card!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!pointer)&#123;</span><br><span class="line">        <span class="built_in">statusBar</span>()-&gt;<span class="built_in">showMessage</span>(errbuf);</span><br><span class="line">        <span class="built_in">pcap_freealldevs</span>(all_devices);</span><br><span class="line">        device = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// check the data link IEEE 802.3</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">pcap_datalink</span>(pointer) != DLT_EN10MB)&#123;</span><br><span class="line">            <span class="built_in">pcap_close</span>(pointer);</span><br><span class="line">            <span class="built_in">pcap_freealldevs</span>(all_devices);</span><br><span class="line">            device = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">statusBar</span>()-&gt;<span class="built_in">showMessage</span>(device-&gt;name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * handleMessage</span></span><br><span class="line"><span class="comment"> * slot function Auto trigger</span></span><br><span class="line"><span class="comment"> * This function will analysis package it received and show in the table</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::handleMessage</span><span class="params">(DataPackage data)</span></span>&#123;</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">insertRow</span>(countNumber);</span><br><span class="line">    <span class="keyword">this</span>-&gt;data.<span class="built_in">push_back</span>(data);</span><br><span class="line">    QString type = data.<span class="built_in">getPackageType</span>();</span><br><span class="line">    QColor color;</span><br><span class="line">    <span class="comment">// show different color</span></span><br><span class="line">    <span class="keyword">if</span>(type == TCP)&#123;</span><br><span class="line">        color = <span class="built_in">QColor</span>(<span class="number">216</span>,<span class="number">191</span>,<span class="number">216</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == TCP)&#123;</span><br><span class="line">        color = <span class="built_in">QColor</span>(<span class="number">144</span>,<span class="number">238</span>,<span class="number">144</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(type == ARP)&#123;</span><br><span class="line">        color = <span class="built_in">QColor</span>(<span class="number">238</span>,<span class="number">238</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(type == DNS)&#123;</span><br><span class="line">        color = <span class="built_in">QColor</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">224</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type == TLS || type == SSL)&#123;</span><br><span class="line">        color = <span class="built_in">QColor</span>(<span class="number">210</span>,<span class="number">149</span>,<span class="number">210</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        color = <span class="built_in">QColor</span>(<span class="number">255</span>,<span class="number">218</span>,<span class="number">185</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">0</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(QString::<span class="built_in">number</span>(countNumber + <span class="number">1</span>)));</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">1</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(data.<span class="built_in">getTimeStamp</span>()));</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">2</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(data.<span class="built_in">getSource</span>()));</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">3</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(data.<span class="built_in">getDestination</span>()));</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">4</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(type));</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">5</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(data.<span class="built_in">getDataLength</span>()));</span><br><span class="line">    ui-&gt;tableWidget-&gt;<span class="built_in">setItem</span>(countNumber,<span class="number">6</span>,<span class="keyword">new</span> <span class="built_in">QTableWidgetItem</span>(data.<span class="built_in">getInfo</span>()));</span><br><span class="line">    <span class="comment">// set color</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">7</span>;i++)&#123;</span><br><span class="line">        ui-&gt;tableWidget-&gt;<span class="built_in">item</span>(countNumber,i)-&gt;<span class="built_in">setBackground</span>(color);</span><br><span class="line">    &#125;</span><br><span class="line">    countNumber++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * on_tableWidget_cellClicked</span></span><br><span class="line"><span class="comment"> * click the table item the detail inforamation will show at the bottom tree widget</span></span><br><span class="line"><span class="comment"> * this function will analysis data pakckage chosed in detail</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_tableWidget_cellClicked</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> column)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rowNumber == row || row &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        ui-&gt;treeWidget-&gt;<span class="built_in">clear</span>();</span><br><span class="line">        rowNumber = row;</span><br><span class="line">        <span class="keyword">if</span>(rowNumber &lt; <span class="number">0</span> || rowNumber &gt; data.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        QString desMac = data[rowNumber].<span class="built_in">getDesMacAddr</span>();</span><br><span class="line">        QString srcMac = data[rowNumber].<span class="built_in">getSrcMacAddr</span>();</span><br><span class="line">        QString type = data[rowNumber].<span class="built_in">getMacType</span>();</span><br><span class="line">        QString tree1 = <span class="string">&quot;Ethernet, Src:&quot;</span> +srcMac + <span class="string">&quot;, Dst:&quot;</span> + desMac;</span><br><span class="line">        QTreeWidgetItem*item = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;tree1);</span><br><span class="line">        ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(item);</span><br><span class="line"></span><br><span class="line">        item-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Destination:&quot;</span> + desMac));</span><br><span class="line">        item-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Source:&quot;</span> + srcMac));</span><br><span class="line">        item-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type:&quot;</span> + type));</span><br><span class="line"></span><br><span class="line">        QString packageType = data[rowNumber].<span class="built_in">getPackageType</span>();</span><br><span class="line">        <span class="comment">// arp package analysis</span></span><br><span class="line">        <span class="keyword">if</span>(packageType == ARP)&#123;</span><br><span class="line">            QString ArpType = data[rowNumber].<span class="built_in">getArpOperationCode</span>();</span><br><span class="line">            QTreeWidgetItem*item2 = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Address Resolution Protocol &quot;</span> + ArpType);</span><br><span class="line">            ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(item2);</span><br><span class="line">            QString HardwareType = data[rowNumber].<span class="built_in">getArpHardwareType</span>();</span><br><span class="line">            QString protocolType = data[rowNumber].<span class="built_in">getArpProtocolType</span>();</span><br><span class="line">            QString HardwareSize = data[rowNumber].<span class="built_in">getArpHardwareLength</span>();</span><br><span class="line">            QString protocolSize = data[rowNumber].<span class="built_in">getArpProtocolLength</span>();</span><br><span class="line">            QString srcMacAddr = data[rowNumber].<span class="built_in">getArpSourceEtherAddr</span>();</span><br><span class="line">            QString desMacAddr = data[rowNumber].<span class="built_in">getArpDestinationEtherAddr</span>();</span><br><span class="line">            QString srcIpAddr = data[rowNumber].<span class="built_in">getArpSourceIpAddr</span>();</span><br><span class="line">            QString desIpAddr = data[rowNumber].<span class="built_in">getArpDestinationIpAddr</span>();</span><br><span class="line"></span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Hardware type:&quot;</span> + HardwareType));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Protocol type:&quot;</span> + protocolType));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Hardware size:&quot;</span> + HardwareSize));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Protocol size:&quot;</span> + protocolSize));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Opcode:&quot;</span> + ArpType));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Sender MAC address:&quot;</span> + srcMacAddr));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Sender IP address:&quot;</span> + srcIpAddr));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Target MAC address:&quot;</span> + desMacAddr));</span><br><span class="line">            item2-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Target IP address:&quot;</span> + desIpAddr));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123; <span class="comment">// ip package analysis</span></span><br><span class="line">            QString srcIp = data[rowNumber].<span class="built_in">getSrcIpAddr</span>();</span><br><span class="line">            QString desIp = data[rowNumber].<span class="built_in">getDesIpAddr</span>();</span><br><span class="line"></span><br><span class="line">            QTreeWidgetItem*item3 = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Internet Protocol Version 4, Src:&quot;</span> + srcIp + <span class="string">&quot;, Dst:&quot;</span> + desIp);</span><br><span class="line">            ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(item3);</span><br><span class="line"></span><br><span class="line">            QString version = data[rowNumber].<span class="built_in">getIpVersion</span>();</span><br><span class="line">            QString headerLength = data[rowNumber].<span class="built_in">getIpHeaderLength</span>();</span><br><span class="line">            QString Tos = data[rowNumber].<span class="built_in">getIpTos</span>();</span><br><span class="line">            QString totalLength = data[rowNumber].<span class="built_in">getIpTotalLength</span>();</span><br><span class="line">            QString id = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getIpIdentification</span>();</span><br><span class="line">            QString flags = data[rowNumber].<span class="built_in">getIpFlag</span>();</span><br><span class="line">            <span class="keyword">if</span>(flags.<span class="built_in">size</span>()&lt;<span class="number">2</span>)</span><br><span class="line">                flags = <span class="string">&quot;0&quot;</span> + flags;</span><br><span class="line">            flags = <span class="string">&quot;0x&quot;</span> + flags;</span><br><span class="line">            QString FragmentOffset = data[rowNumber].<span class="built_in">getIpFragmentOffset</span>();</span><br><span class="line">            QString ttl = data[rowNumber].<span class="built_in">getIpTTL</span>();</span><br><span class="line">            QString protocol = data[rowNumber].<span class="built_in">getIpProtocol</span>();</span><br><span class="line">            QString checksum = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getIpCheckSum</span>();</span><br><span class="line">            <span class="type">int</span> dataLengthofIp = totalLength.<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>() - <span class="number">20</span>;</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;0100 .... = Version:&quot;</span> + version));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... 0101 = Header Length:&quot;</span> + headerLength));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TOS:&quot;</span> + Tos));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Total Length:&quot;</span> + totalLength));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Identification:&quot;</span> + id));</span><br><span class="line"></span><br><span class="line">            QString reservedBit = data[rowNumber].<span class="built_in">getIpReservedBit</span>();</span><br><span class="line">            QString DF = data[rowNumber].<span class="built_in">getIpDF</span>();</span><br><span class="line">            QString MF = data[rowNumber].<span class="built_in">getIpMF</span>();</span><br><span class="line">            QString FLAG = <span class="string">&quot;,&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(reservedBit == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                FLAG += <span class="string">&quot;Reserved bit&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(DF == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                FLAG += <span class="string">&quot;Don&#x27;t fragment&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(MF == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                FLAG += <span class="string">&quot;More fragment&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(FLAG.<span class="built_in">size</span>() == <span class="number">1</span>)</span><br><span class="line">                FLAG = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            QTreeWidgetItem*bitTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Flags:&quot;</span> + flags + FLAG);</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(bitTree);</span><br><span class="line">            QString temp = reservedBit == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">            bitTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;reservedBit + <span class="string">&quot;... .... = Reserved bit:&quot;</span> + temp));</span><br><span class="line">            temp = DF == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">            bitTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.&quot;</span> + DF + <span class="string">&quot;.. .... = Don&#x27;t fragment:&quot;</span> + temp));</span><br><span class="line">            temp = MF == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">            bitTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;..&quot;</span> + MF + <span class="string">&quot;. .... = More fragment:&quot;</span> + temp));</span><br><span class="line"></span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Fragment Offset:&quot;</span> + FragmentOffset));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Time to Live:&quot;</span> + ttl));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Protocol:&quot;</span> + protocol));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Header checksum:&quot;</span> + checksum));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Source Address:&quot;</span> + srcIp));</span><br><span class="line">            item3-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Destination Address:&quot;</span> + desIp));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(packageType == TCP || packageType == TLS || packageType == SSL)&#123;</span><br><span class="line">                QString desPort = data[rowNumber].<span class="built_in">getTcpDestinationPort</span>();</span><br><span class="line">                QString srcPort = data[rowNumber].<span class="built_in">getTcpSourcePort</span>();</span><br><span class="line">                QString ack = data[rowNumber].<span class="built_in">getTcpAcknowledgment</span>();</span><br><span class="line">                QString seq = data[rowNumber].<span class="built_in">getTcpSequence</span>();</span><br><span class="line">                QString headerLength = data[rowNumber].<span class="built_in">getTcpHeaderLength</span>();</span><br><span class="line">                <span class="type">int</span> rawLength = data[rowNumber].<span class="built_in">getTcpRawHeaderLength</span>().<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>();</span><br><span class="line">                dataLengthofIp -= (rawLength * <span class="number">4</span>);</span><br><span class="line">                QString dataLength = QString::<span class="built_in">number</span>(dataLengthofIp);</span><br><span class="line">                QString flag = data[rowNumber].<span class="built_in">getTcpFlags</span>();</span><br><span class="line">                <span class="keyword">while</span>(flag.<span class="built_in">size</span>()&lt;<span class="number">2</span>)</span><br><span class="line">                    flag = <span class="string">&quot;0&quot;</span> + flag;</span><br><span class="line">                flag = <span class="string">&quot;0x&quot;</span> + flag;</span><br><span class="line">                QTreeWidgetItem*item4 = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Transmission Control Protocol, Src Port:&quot;</span> + srcPort + <span class="string">&quot;, Dst Port:&quot;</span> + desPort + <span class="string">&quot;,Seq:&quot;</span> + seq + <span class="string">&quot;, Ack:&quot;</span> + ack + <span class="string">&quot;, Len:&quot;</span> + dataLength);</span><br><span class="line"></span><br><span class="line">                ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(item4);</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Source Port:&quot;</span> + srcPort));</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Destination Port:&quot;</span> + desPort));</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Sequence Number (raw) :&quot;</span> + seq));</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Ackowledgment Number (raw) :&quot;</span> + ack));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                QString sLength = QString::<span class="built_in">number</span>(rawLength,<span class="number">2</span>);</span><br><span class="line">                <span class="keyword">while</span>(sLength.<span class="built_in">size</span>()&lt;<span class="number">4</span>)</span><br><span class="line">                    sLength = <span class="string">&quot;0&quot;</span> + sLength;</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;sLength + <span class="string">&quot; .... = Header Length:&quot;</span> + headerLength));</span><br><span class="line"></span><br><span class="line">                QString PSH = data[rowNumber].<span class="built_in">getTcpPSH</span>();</span><br><span class="line">                QString URG = data[rowNumber].<span class="built_in">getTcpURG</span>();</span><br><span class="line">                QString ACK = data[rowNumber].<span class="built_in">getTcpACK</span>();</span><br><span class="line">                QString RST = data[rowNumber].<span class="built_in">getTcpRST</span>();</span><br><span class="line">                QString SYN = data[rowNumber].<span class="built_in">getTcpSYN</span>();</span><br><span class="line">                QString FIN = data[rowNumber].<span class="built_in">getTcpFIN</span>();</span><br><span class="line">                QString FLAG = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(PSH == <span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    FLAG += <span class="string">&quot;PSH,&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(URG == <span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    FLAG += <span class="string">&quot;UGR,&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(ACK == <span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    FLAG += <span class="string">&quot;ACK,&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(RST == <span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    FLAG += <span class="string">&quot;RST,&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(SYN == <span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    FLAG += <span class="string">&quot;SYN,&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(FIN == <span class="string">&quot;1&quot;</span>)</span><br><span class="line">                    FLAG += <span class="string">&quot;FIN,&quot;</span>;</span><br><span class="line">                FLAG = FLAG.<span class="built_in">left</span>(FLAG.<span class="built_in">length</span>()<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">if</span>(SYN == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                    item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Sequence Number: 0 (relative sequence number)&quot;</span>));</span><br><span class="line">                    item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Acknowledgment Number: 0 (relative ack number)&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(SYN == <span class="string">&quot;1&quot;</span> &amp;&amp; ACK == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                    item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Sequence Number: 0 (relative sequence number)&quot;</span>));</span><br><span class="line">                    item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Acknowledgment Number: 1 (relative ack number)&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">                QTreeWidgetItem*flagTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Flags:&quot;</span> + flag + <span class="string">&quot; (&quot;</span> + FLAG + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(flagTree);</span><br><span class="line">                QString temp = URG == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">                flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... ..&quot;</span> + URG + <span class="string">&quot;. .... = Urgent(URG):&quot;</span> + temp));</span><br><span class="line">                temp = ACK == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">                flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... ...&quot;</span> + ACK + <span class="string">&quot; .... = Acknowledgment(ACK):&quot;</span> + temp));</span><br><span class="line">                temp = PSH == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">                flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... &quot;</span> + PSH + <span class="string">&quot;... = Push(PSH):&quot;</span> + temp));</span><br><span class="line">                temp = RST == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">                flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... .&quot;</span> + RST + <span class="string">&quot;.. = Reset(RST):&quot;</span> + temp));</span><br><span class="line">                temp = SYN == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">                flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... ..&quot;</span> + SYN + <span class="string">&quot;. = Syn(SYN):&quot;</span> + temp));</span><br><span class="line">                temp = FIN == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Set&quot;</span>:<span class="string">&quot;Not set&quot;</span>;</span><br><span class="line">                flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... ...&quot;</span> + FIN + <span class="string">&quot; = Fin(FIN):&quot;</span> + temp));</span><br><span class="line"></span><br><span class="line">                QString window = data[rowNumber].<span class="built_in">getTcpWindowSize</span>();</span><br><span class="line">                QString checksum = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getTcpCheckSum</span>();</span><br><span class="line">                QString urgent = data[rowNumber].<span class="built_in">getTcpUrgentPointer</span>();</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;window:&quot;</span> + window));</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;checksum:&quot;</span> + checksum));</span><br><span class="line">                item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Urgent Pointer:&quot;</span> + urgent));</span><br><span class="line">                <span class="keyword">if</span>((rawLength * <span class="number">4</span>) &gt; <span class="number">20</span>)&#123;</span><br><span class="line">                    QTreeWidgetItem * optionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Options: (&quot;</span> + QString::<span class="built_in">number</span>(rawLength * <span class="number">4</span> - <span class="number">20</span>) + <span class="string">&quot;) bytes&quot;</span>);</span><br><span class="line">                    item4-&gt;<span class="built_in">addChild</span>(optionTree);</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt; (rawLength * <span class="number">4</span> - <span class="number">20</span>);)&#123;</span><br><span class="line">                        <span class="type">int</span> kind = data[rowNumber].<span class="built_in">getTcpOperationRawKind</span>(j);</span><br><span class="line">                        <span class="keyword">switch</span> (kind) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">                            QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - End of List (EOL)&quot;</span>);</span><br><span class="line">                            optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                            subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;kind:End of List (0)&quot;</span>));</span><br><span class="line">                            optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                            j++;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;<span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">                            QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - No-Operation (NOP)&quot;</span>);</span><br><span class="line">                            optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                            subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;kind: No-Operation (1)&quot;</span>));</span><br><span class="line">                            optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                            j++;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">                            u_short mss;</span><br><span class="line">                            <span class="keyword">if</span>(data[rowNumber].<span class="built_in">getTcpOperationMSS</span>(j,mss))&#123;</span><br><span class="line">                                QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - Maximun Segment Size: &quot;</span> + QString::<span class="built_in">number</span>(mss) + <span class="string">&quot; bytes&quot;</span>);</span><br><span class="line">                                optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;kind: Maximun Segment Size (2)&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: 4&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;MSS Value: &quot;</span> + QString::<span class="built_in">number</span>(mss)));</span><br><span class="line">                                j += <span class="number">4</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">                            u_char shift;</span><br><span class="line">                            <span class="keyword">if</span>(data[rowNumber].<span class="built_in">getTcpOperationWSOPT</span>(j,shift))&#123;</span><br><span class="line">                                <span class="type">int</span> factor = <span class="number">1</span> &lt;&lt; shift;</span><br><span class="line">                                QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - Window scale: &quot;</span> + QString::<span class="built_in">number</span>(shift) + <span class="string">&quot; (multiply by &quot;</span> + QString::<span class="built_in">number</span>(factor) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;kind: Window scale (3)&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: 3&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Shift Count: &quot;</span> + QString::<span class="built_in">number</span>(shift)));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;[Multiplier: &quot;</span> + QString::<span class="built_in">number</span>(factor) + <span class="string">&quot;]&quot;</span>));</span><br><span class="line">                                j += <span class="number">3</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">                            <span class="keyword">if</span>(data[rowNumber].<span class="built_in">getTcpOperationSACKP</span>(j))&#123;</span><br><span class="line">                                QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - SACK Permitted&quot;</span>);</span><br><span class="line">                                optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Kind: SCAK Permitted (4)&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: 2&quot;</span>));</span><br><span class="line">                                j += <span class="number">2</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">                            u_char length = <span class="number">0</span>;</span><br><span class="line">                            QVector&lt;u_int&gt;edge;</span><br><span class="line">                            <span class="keyword">if</span>(data[rowNumber].<span class="built_in">getTcpOperationSACK</span>(j,length,edge))&#123;</span><br><span class="line">                                QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - SACK&quot;</span>);</span><br><span class="line">                                optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Kind: SCAK (5)&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line">                                <span class="type">int</span> num = edge.<span class="built_in">size</span>();</span><br><span class="line">                                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; num;k += <span class="number">2</span>)&#123;</span><br><span class="line">                                    subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;left edge = &quot;</span> + QString::<span class="built_in">number</span>(edge[k])));</span><br><span class="line">                                    subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;right edge = &quot;</span> + QString::<span class="built_in">number</span>(edge[k + <span class="number">1</span>])));</span><br><span class="line">                                &#125;</span><br><span class="line">                                j += length;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">8</span>:&#123;</span><br><span class="line">                            u_int value = <span class="number">0</span>;</span><br><span class="line">                            u_int reply = <span class="number">0</span>;</span><br><span class="line">                            <span class="keyword">if</span>(data[rowNumber].<span class="built_in">getTcpOperationTSPOT</span>(j,value,reply))&#123;</span><br><span class="line">                                QString val = QString::<span class="built_in">number</span>(value);</span><br><span class="line">                                QString rep = QString::<span class="built_in">number</span>(reply);</span><br><span class="line">                                QTreeWidgetItem * subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Option - TimeStamps: TSval &quot;</span> +val + <span class="string">&quot;, TSecr &quot;</span> + rep);</span><br><span class="line">                                optionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Kind: Time Stamp Option (8)&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: 10&quot;</span>));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Timestamp value: &quot;</span> + val));</span><br><span class="line">                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Timestamp echo reply: &quot;</span> + rep));</span><br><span class="line">                                j += <span class="number">10</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">19</span>:&#123;</span><br><span class="line">                            j += <span class="number">18</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">28</span>:&#123;</span><br><span class="line">                            j += <span class="number">4</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">default</span>:&#123;</span><br><span class="line">                            j++;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(dataLengthofIp &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                    item4-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;TCP Payload (&quot;</span> + QString::<span class="built_in">number</span>(dataLengthofIp) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                    <span class="keyword">if</span>(packageType == TLS)&#123;</span><br><span class="line">                        QTreeWidgetItem* tlsTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Transport Layer Security&quot;</span>);</span><br><span class="line">                        ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(tlsTree);</span><br><span class="line">                        u_char contentType = <span class="number">0</span>;</span><br><span class="line">                        u_short version = <span class="number">0</span>;</span><br><span class="line">                        u_short length = <span class="number">0</span>;</span><br><span class="line">                        data[rowNumber].<span class="built_in">getTlsBasicInfo</span>((rawLength * <span class="number">4</span>),contentType,version,length);</span><br><span class="line">                        QString type = data[rowNumber].<span class="built_in">getTlsContentType</span>(contentType);</span><br><span class="line">                        QString vs = data[rowNumber].<span class="built_in">getTlsVersion</span>(version);</span><br><span class="line">                        <span class="keyword">switch</span> (contentType) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">20</span>:&#123;</span><br><span class="line">                            <span class="comment">// ... TODO</span></span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">21</span>:&#123;</span><br><span class="line">                            QTreeWidgetItem* tlsSubree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;vs + <span class="string">&quot; Record Layer: Encrypted Alert&quot;</span>);</span><br><span class="line">                            tlsTree-&gt;<span class="built_in">addChild</span>(tlsSubree);</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Content Type: &quot;</span> + type + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(contentType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + vs + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(version,<span class="number">16</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length &quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Alert Message: Encrypted Alert&quot;</span>));</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">22</span>:&#123; <span class="comment">// handshake</span></span><br><span class="line">                            u_char handshakeType = <span class="number">0</span>;</span><br><span class="line">                            data[rowNumber].<span class="built_in">getTlsHandshakeType</span>((rawLength * <span class="number">4</span> + <span class="number">5</span>),handshakeType);</span><br><span class="line">                            <span class="keyword">if</span>(handshakeType == <span class="number">1</span>)&#123; <span class="comment">// client hello</span></span><br><span class="line">                                <span class="type">int</span> tlsLength = <span class="number">0</span>;</span><br><span class="line">                                u_short rawVersion = <span class="number">0</span>;</span><br><span class="line">                                QString random = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                u_char sessionLength = <span class="number">0</span>;</span><br><span class="line">                                QString sessionId = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                u_short cipherLength = <span class="number">0</span>;</span><br><span class="line">                                QVector&lt;u_short&gt;cipher;</span><br><span class="line">                                u_char cmLength = <span class="number">0</span>;</span><br><span class="line">                                QVector&lt;u_char&gt;compressionMethod;</span><br><span class="line">                                u_short extensionLength = <span class="number">0</span>;</span><br><span class="line">                                data[rowNumber].<span class="built_in">getTlsClientHelloInfo</span>((rawLength * <span class="number">4</span> + <span class="number">5</span>),handshakeType,tlsLength,rawVersion,random,sessionLength,sessionId,cipherLength,cipher,cmLength,compressionMethod,extensionLength);</span><br><span class="line"></span><br><span class="line">                                QString type = data[rowNumber].<span class="built_in">getTlsHandshakeType</span>(handshakeType);</span><br><span class="line">                                QString tlsVersion = data[rowNumber].<span class="built_in">getTlsVersion</span>(rawVersion);</span><br><span class="line"></span><br><span class="line">                                QTreeWidgetItem* tlsSubTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;vs + <span class="string">&quot; Record Layer: &quot;</span> + type + <span class="string">&quot; Protocol: &quot;</span> + type);</span><br><span class="line">                                tlsTree-&gt;<span class="built_in">addChild</span>(tlsSubTree);</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Content Type: &quot;</span> + type + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(contentType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + vs + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(version,<span class="number">16</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length &quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line"></span><br><span class="line">                                QTreeWidgetItem* handshakeTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Handshake Protocol: &quot;</span> + type);</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(handshakeTree);</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Handshake Type: &quot;</span> + type + <span class="string">&quot;(&quot;</span> + QString::<span class="built_in">number</span>(handshakeType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(tlsLength)));</span><br><span class="line"></span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + tlsVersion + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(rawVersion) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Random: &quot;</span> + random));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Session ID Length: &quot;</span> + QString::<span class="built_in">number</span>(sessionLength)));</span><br><span class="line">                                <span class="keyword">if</span>(sessionLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                    handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Session ID: &quot;</span> + sessionId));</span><br><span class="line">                                &#125;</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Cipher Suites Length: &quot;</span> + QString::<span class="built_in">number</span>(cipherLength)));</span><br><span class="line">                                <span class="keyword">if</span>(cipherLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                    QTreeWidgetItem* cipherTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Cipher Suites (&quot;</span> + QString::<span class="built_in">number</span>(cipherLength/<span class="number">2</span>) + <span class="string">&quot; suites)&quot;</span>);</span><br><span class="line">                                    handshakeTree-&gt;<span class="built_in">addChild</span>(cipherTree);</span><br><span class="line">                                    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; cipherLength/<span class="number">2</span>;k++)&#123;</span><br><span class="line">                                        QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeCipherSuites</span>(cipher[k]);</span><br><span class="line">                                        cipherTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Cipher Suite: &quot;</span> + temp));</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Compression Method Length: &quot;</span> + QString::<span class="built_in">number</span>(cmLength)));</span><br><span class="line">                                <span class="keyword">if</span>(cmLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                    QTreeWidgetItem* cmTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Compression Methods (&quot;</span> + QString::<span class="built_in">number</span>(cmLength) + <span class="string">&quot; method)&quot;</span>);</span><br><span class="line">                                    handshakeTree-&gt;<span class="built_in">addChild</span>(cmTree);</span><br><span class="line">                                    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; cmLength;k++)&#123;</span><br><span class="line">                                        QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeCompression</span>(compressionMethod[k]);</span><br><span class="line">                                        cmTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Compression Methods: &quot;</span> + temp + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(compressionMethod[k]) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extensions Length: &quot;</span> + QString::<span class="built_in">number</span>(extensionLength)));</span><br><span class="line">                                <span class="keyword">if</span>(extensionLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                    <span class="type">int</span> exOffset = (rawLength * <span class="number">4</span>) + (tlsLength - extensionLength + <span class="number">5</span> + <span class="number">4</span>);</span><br><span class="line">                                    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; extensionLength;)&#123;</span><br><span class="line">                                        <span class="type">int</span> code = data[rowNumber].<span class="built_in">getTlsExtensionType</span>(exOffset);</span><br><span class="line">                                        u_short exType = <span class="number">0</span>;</span><br><span class="line">                                        u_short exLength = <span class="number">0</span>;</span><br><span class="line">                                        <span class="keyword">switch</span> (code) &#123;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">0</span>:&#123; <span class="comment">// server_name</span></span><br><span class="line">                                            u_short listLength = <span class="number">0</span>;</span><br><span class="line">                                            u_char nameType = <span class="number">0</span>;</span><br><span class="line">                                            u_short nameLength = <span class="number">0</span>;</span><br><span class="line">                                            QString name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionServerName</span>(exOffset,exType,exLength,listLength,nameType,nameLength,name);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">if</span>(exLength &gt; <span class="number">0</span> &amp;&amp; listLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                                QTreeWidgetItem*serverTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name Indication extension&quot;</span>);</span><br><span class="line">                                                extensionTree-&gt;<span class="built_in">addChild</span>(serverTree);</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name list length: &quot;</span> + QString::<span class="built_in">number</span>(listLength)));</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name Type: &quot;</span> + QString::<span class="built_in">number</span>(nameType)));</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name length: &quot;</span> + QString::<span class="built_in">number</span>(nameLength)));</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name: &quot;</span> + name));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">11</span>:&#123;<span class="comment">// ec_point_format</span></span><br><span class="line">                                            u_char ecLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_char&gt;EC;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionEcPointFormats</span>(exOffset,exType,exLength,ecLength,EC);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;EC point formats Length: &quot;</span> + QString::<span class="built_in">number</span>(ecLength)));</span><br><span class="line">                                            QTreeWidgetItem* EXTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Elliptic curves point formats (&quot;</span> + QString::<span class="built_in">number</span>(ecLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(EXTree);</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; ecLength;g++)&#123;</span><br><span class="line">                                                QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeExtensionECPointFormat</span>(EC[g]);</span><br><span class="line">                                                EXTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;temp));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">10</span>:&#123;<span class="comment">// supported_groups</span></span><br><span class="line">                                            u_short groupListLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_short&gt;group;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSupportGroups</span>(exOffset,exType,exLength,groupListLength,group);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Groups List Length: &quot;</span> + QString::<span class="built_in">number</span>(groupListLength)));</span><br><span class="line">                                            QTreeWidgetItem* sptTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Groups (&quot;</span> + QString::<span class="built_in">number</span>(groupListLength/<span class="number">2</span>) + <span class="string">&quot; groups)&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(sptTree);</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; groupListLength/<span class="number">2</span>;g++)&#123;</span><br><span class="line">                                                QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeExtensionSupportGroup</span>(group[g]);</span><br><span class="line">                                                sptTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Group: &quot;</span> + temp));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">35</span>:&#123;<span class="comment">// session_ticket</span></span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSessionTicket</span>(exOffset,exType,exLength);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">22</span>:&#123;<span class="comment">// encrypt_then_mac</span></span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionEncryptThenMac</span>(exOffset,exType,exLength);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">23</span>:&#123;<span class="comment">// extended_master_secret</span></span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionExtendMasterSecret</span>(exOffset,exType,exLength);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">13</span>:&#123;<span class="comment">// signature_algorithms</span></span><br><span class="line">                                            u_short algorithmLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_short&gt;algorithm;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSignatureAlgorithms</span>(exOffset,exType,exLength,algorithmLength,algorithm);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithms Length: &quot;</span> + QString::<span class="built_in">number</span>(algorithmLength)));</span><br><span class="line">                                            QTreeWidgetItem* sigTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithms (&quot;</span> + QString::<span class="built_in">number</span>(algorithmLength/<span class="number">2</span>) + <span class="string">&quot; algorithms)&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(sigTree);</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; algorithmLength/<span class="number">2</span>;g++)&#123;</span><br><span class="line">                                                QTreeWidgetItem*subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Algorithm: 0x0&quot;</span> + QString::<span class="built_in">number</span>(algorithm[g],<span class="number">16</span>));</span><br><span class="line">                                                sigTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                                QString hash = data[rowNumber].<span class="built_in">getTlsHadshakeExtensionHash</span>((algorithm[g] &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line">                                                QString sig = data[rowNumber].<span class="built_in">getTlsHadshakeExtensionSignature</span>((algorithm[g] &amp; <span class="number">0x00ff</span>));</span><br><span class="line">                                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithm Hash: &quot;</span> + hash + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>((algorithm[g] &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithm Signature: &quot;</span> + sig + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(algorithm[g] &amp; <span class="number">0x00ff</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">43</span>:&#123;<span class="comment">// supported_versions</span></span><br><span class="line">                                            u_char supportLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_short&gt;supportVersion;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSupportVersions</span>(exOffset,exType,exLength,supportLength,supportVersion);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Versions length: &quot;</span> + QString::<span class="built_in">number</span>(supportLength)));</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; supportLength/<span class="number">2</span>;g++)&#123;</span><br><span class="line">                                                QString temp = data[rowNumber].<span class="built_in">getTlsVersion</span>(supportVersion[g]);</span><br><span class="line">                                                extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Version: &quot;</span> + temp));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">51</span>:&#123;<span class="comment">// key_share</span></span><br><span class="line">                                            u_short shareLength = <span class="number">0</span>;</span><br><span class="line">                                            u_short group = <span class="number">0</span>;</span><br><span class="line">                                            u_short exchangeLength = <span class="number">0</span>;</span><br><span class="line">                                            QString exchange = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionKeyShare</span>(exOffset,exType,exLength,shareLength,group,exchangeLength,exchange);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line"></span><br><span class="line">                                            QTreeWidgetItem*subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Share extension&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                            subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Client Key Share Length: &quot;</span> + QString::<span class="built_in">number</span>(shareLength)));</span><br><span class="line">                                            QTreeWidgetItem* entryTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Share Entry: Group &quot;</span>);</span><br><span class="line">                                            subTree-&gt;<span class="built_in">addChild</span>(entryTree);</span><br><span class="line">                                            entryTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Group: &quot;</span> + QString::<span class="built_in">number</span>(group)));</span><br><span class="line">                                            entryTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Exchange Length: &quot;</span> + QString::<span class="built_in">number</span>(exchangeLength)));</span><br><span class="line">                                            entryTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Exchange: &quot;</span> + exchange));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">21</span>:&#123;<span class="comment">// padding</span></span><br><span class="line">                                            QString rdata = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionPadding</span>(exOffset,exType,exLength,rdata);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType + <span class="string">&quot; (21)&quot;</span>));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Padding Data: &quot;</span> + rdata));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">default</span>:&#123;</span><br><span class="line">                                            QString rdata = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionOther</span>(exOffset,exType,exLength,rdata);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(exType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Data: &quot;</span> + rdata));</span><br><span class="line"></span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        k += (exLength + <span class="number">4</span>);</span><br><span class="line">                                        exOffset += (exLength + <span class="number">4</span>);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span>(handshakeType == <span class="number">2</span>)&#123;<span class="comment">// Server hello</span></span><br><span class="line">                                <span class="type">int</span> tlsLength = <span class="number">0</span>;</span><br><span class="line">                                u_short rawVersion = <span class="number">0</span>;</span><br><span class="line">                                QString random = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                u_char sessionLength = <span class="number">0</span>;</span><br><span class="line">                                QString sessionId = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                u_short cipher = <span class="number">0</span>;</span><br><span class="line">                                u_char compressionMethod = <span class="number">0</span>;</span><br><span class="line">                                u_short extensionLength = <span class="number">0</span>;</span><br><span class="line">                                data[rowNumber].<span class="built_in">getTlsServerHelloInfo</span>((rawLength * <span class="number">4</span> + <span class="number">5</span>),handshakeType,tlsLength,rawVersion,random,sessionLength,sessionId,cipher,compressionMethod,extensionLength);</span><br><span class="line">                                QString type = data[rowNumber].<span class="built_in">getTlsHandshakeType</span>(handshakeType);</span><br><span class="line">                                QString tlsVersion = data[rowNumber].<span class="built_in">getTlsVersion</span>(rawVersion);</span><br><span class="line"></span><br><span class="line">                                QTreeWidgetItem* tlsSubTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;vs + <span class="string">&quot; Record Layer: &quot;</span> + type + <span class="string">&quot; Protocol: &quot;</span> + type);</span><br><span class="line">                                tlsTree-&gt;<span class="built_in">addChild</span>(tlsSubTree);</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Content Type: &quot;</span> + type + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(contentType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + vs + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(version,<span class="number">16</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length &quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line"></span><br><span class="line">                                QTreeWidgetItem* handshakeTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Handshake Protocol: &quot;</span> + type);</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(handshakeTree);</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Handshake Type: &quot;</span> + type + <span class="string">&quot;(&quot;</span> + QString::<span class="built_in">number</span>(handshakeType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(tlsLength)));</span><br><span class="line"></span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + tlsVersion + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(rawVersion,<span class="number">16</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Random: &quot;</span> + random));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Session ID Length: &quot;</span> + QString::<span class="built_in">number</span>(sessionLength)));</span><br><span class="line">                                <span class="keyword">if</span>(sessionLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                    handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Session ID: &quot;</span> + sessionId));</span><br><span class="line">                                &#125;</span><br><span class="line">                                QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeCipherSuites</span>(cipher);</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Cipher Suites: &quot;</span> +temp));</span><br><span class="line">                                temp = data[rowNumber].<span class="built_in">getTlsHandshakeCompression</span>(compressionMethod);</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Compression Methods: &quot;</span> + temp + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(compressionMethod) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extensions Length: &quot;</span> + QString::<span class="built_in">number</span>(extensionLength)));</span><br><span class="line">                                <span class="keyword">if</span>(extensionLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                    <span class="type">int</span> exOffset = (rawLength * <span class="number">4</span>) + (tlsLength - extensionLength + <span class="number">5</span> + <span class="number">4</span>);</span><br><span class="line">                                    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; extensionLength;)&#123;</span><br><span class="line">                                        <span class="type">int</span> code = data[rowNumber].<span class="built_in">getTlsExtensionType</span>(exOffset);</span><br><span class="line">                                        u_short exType = <span class="number">0</span>;</span><br><span class="line">                                        u_short exLength = <span class="number">0</span>;</span><br><span class="line">                                        <span class="keyword">switch</span> (code) &#123;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">0</span>:&#123; <span class="comment">// server_name</span></span><br><span class="line">                                            u_short listLength = <span class="number">0</span>;</span><br><span class="line">                                            u_char nameType = <span class="number">0</span>;</span><br><span class="line">                                            u_short nameLength = <span class="number">0</span>;</span><br><span class="line">                                            QString name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionServerName</span>(exOffset,exType,exLength,listLength,nameType,nameLength,name);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">if</span>(exLength &gt; <span class="number">0</span> &amp;&amp; listLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                                QTreeWidgetItem*serverTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name Indication extension&quot;</span>);</span><br><span class="line">                                                extensionTree-&gt;<span class="built_in">addChild</span>(serverTree);</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name list length: &quot;</span> + QString::<span class="built_in">number</span>(listLength)));</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name Type: &quot;</span> + QString::<span class="built_in">number</span>(nameType)));</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name length: &quot;</span> + QString::<span class="built_in">number</span>(nameLength)));</span><br><span class="line">                                                serverTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Server Name: &quot;</span> + name));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">11</span>:&#123;<span class="comment">// ec_point_format</span></span><br><span class="line">                                            u_char ecLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_char&gt;EC;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionEcPointFormats</span>(exOffset,exType,exLength,ecLength,EC);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;EC point formats Length: &quot;</span> + QString::<span class="built_in">number</span>(ecLength)));</span><br><span class="line">                                            QTreeWidgetItem* EXTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Elliptic curves point formats (&quot;</span> + QString::<span class="built_in">number</span>(ecLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(EXTree);</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; ecLength;g++)&#123;</span><br><span class="line">                                                QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeExtensionECPointFormat</span>(EC[g]);</span><br><span class="line">                                                EXTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;temp));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">10</span>:&#123;<span class="comment">// supported_groups</span></span><br><span class="line">                                            u_short groupListLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_short&gt;group;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSupportGroups</span>(exOffset,exType,exLength,groupListLength,group);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Groups List Length: &quot;</span> + QString::<span class="built_in">number</span>(groupListLength)));</span><br><span class="line">                                            QTreeWidgetItem* sptTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Groups (&quot;</span> + QString::<span class="built_in">number</span>(groupListLength/<span class="number">2</span>) + <span class="string">&quot; groups)&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(sptTree);</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; groupListLength/<span class="number">2</span>;g++)&#123;</span><br><span class="line">                                                QString temp = data[rowNumber].<span class="built_in">getTlsHandshakeExtensionSupportGroup</span>(group[g]);</span><br><span class="line">                                                sptTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Group: &quot;</span> + temp));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">35</span>:&#123;<span class="comment">// session_ticket</span></span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSessionTicket</span>(exOffset,exType,exLength);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">22</span>:&#123;<span class="comment">// encrypt_then_mac</span></span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionEncryptThenMac</span>(exOffset,exType,exLength);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">23</span>:&#123;<span class="comment">// extended_master_secret</span></span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionExtendMasterSecret</span>(exOffset,exType,exLength);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">13</span>:&#123;<span class="comment">// signature_algorithms</span></span><br><span class="line">                                            u_short algorithmLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_short&gt;algorithm;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSignatureAlgorithms</span>(exOffset,exType,exLength,algorithmLength,algorithm);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithms Length: &quot;</span> + QString::<span class="built_in">number</span>(algorithmLength)));</span><br><span class="line">                                            QTreeWidgetItem* sigTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithms (&quot;</span> + QString::<span class="built_in">number</span>(algorithmLength/<span class="number">2</span>) + <span class="string">&quot; algorithms)&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(sigTree);</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; algorithmLength/<span class="number">2</span>;g++)&#123;</span><br><span class="line">                                                QTreeWidgetItem*subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Algorithm: 0x0&quot;</span> + QString::<span class="built_in">number</span>(algorithm[g],<span class="number">16</span>));</span><br><span class="line">                                                sigTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                                QString hash = data[rowNumber].<span class="built_in">getTlsHadshakeExtensionHash</span>((algorithm[g] &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line">                                                QString sig = data[rowNumber].<span class="built_in">getTlsHadshakeExtensionSignature</span>((algorithm[g] &amp; <span class="number">0x00ff</span>));</span><br><span class="line">                                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithm Hash: &quot;</span> + hash + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>((algorithm[g] &amp; <span class="number">0xff00</span>) &gt;&gt; <span class="number">8</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                                subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Signature Hash Algorithm Signature: &quot;</span> + sig + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(algorithm[g] &amp; <span class="number">0x00ff</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">43</span>:&#123;<span class="comment">// supported_versions</span></span><br><span class="line">                                            u_char supportLength = <span class="number">0</span>;</span><br><span class="line">                                            QVector&lt;u_short&gt;supportVersion;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionSupportVersions</span>(exOffset,exType,exLength,supportLength,supportVersion);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Versions length: &quot;</span> + QString::<span class="built_in">number</span>(supportLength)));</span><br><span class="line">                                            <span class="keyword">for</span>(<span class="type">int</span> g = <span class="number">0</span>;g &lt; supportLength/<span class="number">2</span>;g++)&#123;</span><br><span class="line">                                                QString temp = data[rowNumber].<span class="built_in">getTlsVersion</span>(supportVersion[g]);</span><br><span class="line">                                                extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Supported Version: &quot;</span> + temp));</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">51</span>:&#123;<span class="comment">// key_share</span></span><br><span class="line">                                            u_short shareLength = <span class="number">0</span>;</span><br><span class="line">                                            u_short group = <span class="number">0</span>;</span><br><span class="line">                                            u_short exchangeLength = <span class="number">0</span>;</span><br><span class="line">                                            QString exchange = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionKeyShare</span>(exOffset,exType,exLength,shareLength,group,exchangeLength,exchange);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line"></span><br><span class="line">                                            QTreeWidgetItem*subTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Share extension&quot;</span>);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(subTree);</span><br><span class="line">                                            subTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Client Key Share Length: &quot;</span> + QString::<span class="built_in">number</span>(shareLength)));</span><br><span class="line">                                            QTreeWidgetItem* entryTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Share Entry: Group &quot;</span>);</span><br><span class="line">                                            subTree-&gt;<span class="built_in">addChild</span>(entryTree);</span><br><span class="line">                                            entryTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Group: &quot;</span> + QString::<span class="built_in">number</span>(group)));</span><br><span class="line">                                            entryTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Exchange Length: &quot;</span> + QString::<span class="built_in">number</span>(exchangeLength)));</span><br><span class="line">                                            entryTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Key Exchange: &quot;</span> + exchange));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="number">21</span>:&#123;<span class="comment">// padding</span></span><br><span class="line">                                            QString rdata = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionPadding</span>(exOffset,exType,exLength,rdata);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType + <span class="string">&quot; (21)&quot;</span>));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Padding Data: &quot;</span> + rdata));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        <span class="keyword">default</span>:&#123;</span><br><span class="line">                                            QString rdata = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                            data[rowNumber].<span class="built_in">getTlsExtensionOther</span>(exOffset,exType,exLength,rdata);</span><br><span class="line">                                            QString subType = data[rowNumber].<span class="built_in">getTlsHandshakeExtension</span>(exType);</span><br><span class="line">                                            QTreeWidgetItem*extensionTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Extension: &quot;</span> + subType + <span class="string">&quot; (len=&quot;</span> + QString::<span class="built_in">number</span>(exLength) + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                                            handshakeTree-&gt;<span class="built_in">addChild</span>(extensionTree);</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type: &quot;</span> + subType + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(exType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(exLength)));</span><br><span class="line">                                            extensionTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Data: &quot;</span> + rdata));</span><br><span class="line"></span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        k += (exLength + <span class="number">4</span>);</span><br><span class="line">                                        exOffset += (exLength + <span class="number">4</span>);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span>(handshakeType == <span class="number">12</span>)&#123;<span class="comment">// Server Key Exchange</span></span><br><span class="line">                                <span class="type">int</span> tlsLength = <span class="number">0</span>;</span><br><span class="line">                                u_char curveType = <span class="number">0</span>;</span><br><span class="line">                                u_short curveName = <span class="number">0</span>;</span><br><span class="line">                                u_char pubLength = <span class="number">0</span>;</span><br><span class="line">                                QString pubKey = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                u_short sigAlgorithm = <span class="number">0</span>;</span><br><span class="line">                                u_short sigLength = <span class="number">0</span>;</span><br><span class="line">                                QString sig = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                                data[rowNumber].<span class="built_in">getTlsServerKeyExchange</span>((rawLength * <span class="number">4</span> + <span class="number">5</span>),handshakeType,tlsLength,curveType,curveName,pubLength,pubKey,sigAlgorithm,sigLength,sig);</span><br><span class="line">                                QString type = data[rowNumber].<span class="built_in">getTlsHandshakeType</span>(handshakeType);</span><br><span class="line"></span><br><span class="line">                                QTreeWidgetItem* tlsSubTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;vs + <span class="string">&quot; Record Layer: &quot;</span> + type + <span class="string">&quot; Protocol: &quot;</span> + type);</span><br><span class="line">                                tlsTree-&gt;<span class="built_in">addChild</span>(tlsSubTree);</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Content Type: &quot;</span> + type + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(contentType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + vs + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(version,<span class="number">16</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length &quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line"></span><br><span class="line">                                QTreeWidgetItem* handshakeTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Handshake Protocol: &quot;</span> + type);</span><br><span class="line">                                tlsSubTree-&gt;<span class="built_in">addChild</span>(handshakeTree);</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Handshake Type: &quot;</span> + type + <span class="string">&quot;(&quot;</span> + QString::<span class="built_in">number</span>(handshakeType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                                handshakeTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length: &quot;</span> + QString::<span class="built_in">number</span>(tlsLength)));</span><br><span class="line"></span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="comment">// ... TODO</span></span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">23</span>:&#123;</span><br><span class="line">                            QTreeWidgetItem* tlsSubree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;vs + <span class="string">&quot; Record Layer: &quot;</span> + type + <span class="string">&quot; Protocol: http-over-tls&quot;</span>);</span><br><span class="line">                            tlsTree-&gt;<span class="built_in">addChild</span>(tlsSubree);</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Content Type: &quot;</span> + type + <span class="string">&quot; (&quot;</span> + QString::<span class="built_in">number</span>(contentType) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Version: &quot;</span> + vs + <span class="string">&quot; (0x0&quot;</span> + QString::<span class="built_in">number</span>(version,<span class="number">16</span>) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Length &quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line">                            tlsSubree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Encrypted Application Data: ...&quot;</span>));</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">default</span>:<span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(packageType == SSL)&#123;</span><br><span class="line">                        ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Transport Layer Security&quot;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(packageType == UDP || packageType == DNS)&#123;</span><br><span class="line">                QString srcPort = data[rowNumber].<span class="built_in">getUdpSourcePort</span>();</span><br><span class="line">                QString desPort = data[rowNumber].<span class="built_in">getUdpDestinationPort</span>();</span><br><span class="line">                QString Length = data[rowNumber].<span class="built_in">getUdpDataLength</span>();</span><br><span class="line">                QString checksum = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getUdpCheckSum</span>();</span><br><span class="line">                QTreeWidgetItem*item5 = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;User Datagram Protocol, Src Port:&quot;</span> + srcPort + <span class="string">&quot;, Dst Port:&quot;</span> + desPort);</span><br><span class="line">                ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(item5);</span><br><span class="line">                item5-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Source Port:&quot;</span> + srcPort));</span><br><span class="line">                item5-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Destination Port:&quot;</span> + desPort));</span><br><span class="line">                item5-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;length:&quot;</span> + Length));</span><br><span class="line">                item5-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Checksum:&quot;</span> + checksum));</span><br><span class="line">                <span class="type">int</span> udpLength = Length.<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>();</span><br><span class="line">                <span class="keyword">if</span>(udpLength &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                    item5-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;UDP PayLoad (&quot;</span> + QString::<span class="built_in">number</span>(udpLength - <span class="number">8</span>) + <span class="string">&quot; bytes)&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(packageType == DNS)&#123;</span><br><span class="line">                    QString transaction = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getDnsTransactionId</span>();</span><br><span class="line">                    QString QR = data[rowNumber].<span class="built_in">getDnsFlagsQR</span>();</span><br><span class="line">                    QString temp = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(QR == <span class="string">&quot;0&quot;</span>) temp = <span class="string">&quot;query&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(QR == <span class="string">&quot;1&quot;</span>) temp = <span class="string">&quot;response&quot;</span>;</span><br><span class="line">                    QString flags = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getDnsFlags</span>();</span><br><span class="line">                    QTreeWidgetItem*dnsTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Domain Name System (&quot;</span> + temp + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">                    ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(dnsTree);</span><br><span class="line">                    dnsTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Transaction ID:&quot;</span> + transaction));</span><br><span class="line">                    QTreeWidgetItem* flagTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Flags:&quot;</span> + flags);</span><br><span class="line">                    dnsTree-&gt;<span class="built_in">addChild</span>(flagTree);</span><br><span class="line">                    temp = QR == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Message is a response&quot;</span>:<span class="string">&quot;Message is a query&quot;</span>;</span><br><span class="line">                    flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;QR + <span class="string">&quot;... .... .... .... = Response:&quot;</span> + temp));</span><br><span class="line">                    QString Opcode = data[rowNumber].<span class="built_in">getDnsFlagsOpcode</span>();</span><br><span class="line">                    <span class="keyword">if</span>(Opcode == <span class="string">&quot;0&quot;</span>) temp = <span class="string">&quot;Standard query (0)&quot;</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(Opcode == <span class="string">&quot;1&quot;</span>) temp = <span class="string">&quot;Reverse query (1)&quot;</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(Opcode == <span class="string">&quot;2&quot;</span>) temp = <span class="string">&quot;Status request (2)&quot;</span>;</span><br><span class="line">                    flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.000 &quot;</span> + Opcode + <span class="string">&quot;... .... .... = Opcode:&quot;</span> + temp));</span><br><span class="line">                    <span class="keyword">if</span>(QR == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                        QString AA = data[rowNumber].<span class="built_in">getDnsFlagsAA</span>();</span><br><span class="line">                        temp = AA == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Server is an authority for domain&quot;</span>:<span class="string">&quot;Server is not an authority for domain&quot;</span>;</span><br><span class="line">                        flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .&quot;</span> + AA + <span class="string">&quot;.. .... .... = Authoritative:&quot;</span> + temp));</span><br><span class="line">                    &#125;</span><br><span class="line">                    QString TC = data[rowNumber].<span class="built_in">getDnsFlagsTC</span>();</span><br><span class="line">                    temp = TC == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Message is truncated&quot;</span>:<span class="string">&quot;Message is not truncated&quot;</span>;</span><br><span class="line">                    flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... ..&quot;</span> + TC + <span class="string">&quot;. .... .... = Truncated:&quot;</span> + temp));</span><br><span class="line"></span><br><span class="line">                    QString RD = data[rowNumber].<span class="built_in">getDnsFlagsRD</span>();</span><br><span class="line">                    temp = RD == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Do query recursively&quot;</span>:<span class="string">&quot;Do query not recursively&quot;</span>;</span><br><span class="line">                    flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... ...&quot;</span> + RD + <span class="string">&quot; .... .... = Recursion desired:&quot;</span> + temp));</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(QR == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                        QString RA = data[rowNumber].<span class="built_in">getDnsFlagsRA</span>();</span><br><span class="line">                        temp = RA == <span class="string">&quot;1&quot;</span>?<span class="string">&quot;Server can do recursive queries&quot;</span>:<span class="string">&quot;Server can not do recursive queries&quot;</span>;</span><br><span class="line">                        flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... &quot;</span> + RA + <span class="string">&quot;... .... = Recursion available:&quot;</span> + temp));</span><br><span class="line">                    &#125;</span><br><span class="line">                    QString Z = data[rowNumber].<span class="built_in">getDnsFlagsZ</span>();</span><br><span class="line">                    <span class="keyword">while</span>(Z.<span class="built_in">size</span>()&lt;<span class="number">3</span>)</span><br><span class="line">                        Z = <span class="string">&quot;0&quot;</span> + Z;</span><br><span class="line">                    flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... .&quot;</span> + Z + <span class="string">&quot; .... = Z:reserved(&quot;</span> + Z + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                    <span class="keyword">if</span>(QR == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                        QString Rcode = data[rowNumber].<span class="built_in">getDnsFlagsRcode</span>();</span><br><span class="line">                        <span class="keyword">if</span>(Rcode == <span class="string">&quot;0&quot;</span>)</span><br><span class="line">                            temp = <span class="string">&quot;No error (0)&quot;</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(Rcode == <span class="string">&quot;1&quot;</span>) temp = <span class="string">&quot;Format error (1)&quot;</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(Rcode == <span class="string">&quot;2&quot;</span>) temp = <span class="string">&quot;Server failure (2)&quot;</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(Rcode == <span class="string">&quot;3&quot;</span>) temp = <span class="string">&quot;Name Error (3)&quot;</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(Rcode == <span class="string">&quot;4&quot;</span>) temp = <span class="string">&quot;Not Implemented (4)&quot;</span>;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(Rcode == <span class="string">&quot;5&quot;</span>) temp = <span class="string">&quot;Refused (5)&quot;</span>;</span><br><span class="line">                        <span class="type">int</span> code = Rcode.<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>();</span><br><span class="line">                        QString bCode = QString::<span class="built_in">number</span>(code,<span class="number">2</span>);</span><br><span class="line">                        <span class="keyword">while</span> (bCode.<span class="built_in">size</span>()&lt;<span class="number">4</span>)</span><br><span class="line">                            bCode = <span class="string">&quot;0&quot;</span> + bCode;</span><br><span class="line">                        flagTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;.... .... .... &quot;</span> + bCode + <span class="string">&quot; = Reply code:&quot;</span> + temp));</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    QString question = data[rowNumber].<span class="built_in">getDnsQuestionNumber</span>();</span><br><span class="line">                    dnsTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Questions:&quot;</span> + question));</span><br><span class="line">                    QString answer = data[rowNumber].<span class="built_in">getDnsAnswerNumber</span>();</span><br><span class="line">                    dnsTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Answer RRs:&quot;</span> + answer));</span><br><span class="line">                    QString authority = data[rowNumber].<span class="built_in">getDnsAuthorityNumber</span>();</span><br><span class="line">                    dnsTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Authority RRs:&quot;</span> + authority));</span><br><span class="line">                    QString additional = data[rowNumber].<span class="built_in">getDnsAdditionalNumber</span>();</span><br><span class="line">                    dnsTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Additional RRs:&quot;</span> + additional));</span><br><span class="line">                    <span class="type">int</span> offset = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">if</span>(question == <span class="string">&quot;1&quot;</span>)&#123;</span><br><span class="line">                        QString domainInfo;</span><br><span class="line">                        <span class="type">int</span> Type;</span><br><span class="line">                        <span class="type">int</span> Class;</span><br><span class="line">                        data[rowNumber].<span class="built_in">getDnsQueriesDomain</span>(domainInfo,Type,Class);</span><br><span class="line">                        QTreeWidgetItem*queryDomainTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Queries&quot;</span>);</span><br><span class="line">                        dnsTree-&gt;<span class="built_in">addChild</span>(queryDomainTree);</span><br><span class="line">                        offset += (<span class="number">4</span> + domainInfo.<span class="built_in">size</span>() + <span class="number">2</span>);</span><br><span class="line">                        QString type = data[rowNumber].<span class="built_in">getDnsDomainType</span>(Type);</span><br><span class="line">                        QTreeWidgetItem*querySubTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;domainInfo + <span class="string">&quot; type &quot;</span> + type + <span class="string">&quot;, class IN&quot;</span>);</span><br><span class="line">                        queryDomainTree-&gt;<span class="built_in">addChild</span>(querySubTree);</span><br><span class="line">                        querySubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Name:&quot;</span> + domainInfo));</span><br><span class="line">                        querySubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;[Name Length:&quot;</span> + QString::<span class="built_in">number</span>(domainInfo.<span class="built_in">size</span>()) + <span class="string">&quot;]&quot;</span>));</span><br><span class="line">                        querySubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type:&quot;</span> + type + <span class="string">&quot;(&quot;</span> + QString::<span class="built_in">number</span>(Type) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                        querySubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Class: IN (0x000&quot;</span> + QString::<span class="built_in">number</span>(Class) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">int</span> answerNumber = answer.<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>();</span><br><span class="line">                    <span class="keyword">if</span>(answerNumber &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                        QTreeWidgetItem*answerTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Answers&quot;</span>);</span><br><span class="line">                        dnsTree-&gt;<span class="built_in">addChild</span>(answerTree);</span><br><span class="line">                        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt; answerNumber;i++)&#123;</span><br><span class="line">                            QString name1;</span><br><span class="line">                            QString name2;</span><br><span class="line">                            u_short type;</span><br><span class="line">                            u_short Class;</span><br><span class="line">                            u_int ttl;</span><br><span class="line">                            u_short length;</span><br><span class="line"></span><br><span class="line">                            <span class="type">int</span> tempOffset = data[rowNumber].<span class="built_in">getDnsAnswersDomain</span>(offset,name1,type,Class,ttl,length,name2);</span><br><span class="line">                            QString sType = data[rowNumber].<span class="built_in">getDnsDomainType</span>(type);</span><br><span class="line">                            QString temp = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                            <span class="keyword">if</span>(type == <span class="number">1</span>) temp = <span class="string">&quot;addr&quot;</span>;</span><br><span class="line">                            <span class="keyword">else</span> <span class="keyword">if</span>(type == <span class="number">5</span>) temp = <span class="string">&quot;cname&quot;</span>;</span><br><span class="line">                            QTreeWidgetItem*answerSubTree = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;name1 + <span class="string">&quot;: type &quot;</span> + sType + <span class="string">&quot;,class IN, &quot;</span> + temp + <span class="string">&quot;:&quot;</span> + name2);</span><br><span class="line">                            answerTree-&gt;<span class="built_in">addChild</span>(answerSubTree);</span><br><span class="line">                            answerSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Name:&quot;</span> + name1));</span><br><span class="line">                            answerSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Type:&quot;</span> + sType + <span class="string">&quot;(&quot;</span> + QString::<span class="built_in">number</span>(type) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                            answerSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Class: IN (0x000&quot;</span> + QString::<span class="built_in">number</span>(Class) + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                            answerSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Time to live:&quot;</span> + QString::<span class="built_in">number</span>(ttl) + <span class="string">&quot;(&quot;</span> + QString::<span class="built_in">number</span>(ttl) + <span class="string">&quot; second)&quot;</span>));</span><br><span class="line">                            answerSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Data length:&quot;</span> + QString::<span class="built_in">number</span>(length)));</span><br><span class="line">                            answerSubTree-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;sType + <span class="string">&quot;:&quot;</span> + name2));</span><br><span class="line"></span><br><span class="line">                            offset += tempOffset;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(packageType == ICMP)&#123;</span><br><span class="line">                dataLengthofIp -= <span class="number">8</span>;</span><br><span class="line">                QTreeWidgetItem*item6 = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Internet Message Protocol&quot;</span>);</span><br><span class="line">                ui-&gt;treeWidget-&gt;<span class="built_in">addTopLevelItem</span>(item6);</span><br><span class="line">                QString type = data[rowNumber].<span class="built_in">getIcmpType</span>();</span><br><span class="line">                QString code = data[rowNumber].<span class="built_in">getIcmpCode</span>();</span><br><span class="line">                QString info = ui-&gt;tableWidget-&gt;<span class="built_in">item</span>(row,<span class="number">6</span>)-&gt;<span class="built_in">text</span>();</span><br><span class="line">                QString checksum = <span class="string">&quot;0x&quot;</span> + data[rowNumber].<span class="built_in">getIcmpCheckSum</span>();</span><br><span class="line">                QString id = data[rowNumber].<span class="built_in">getIcmpIdentification</span>();</span><br><span class="line">                QString seq = data[rowNumber].<span class="built_in">getIcmpSequeue</span>();</span><br><span class="line">                item6-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;type:&quot;</span> + type + <span class="string">&quot;(&quot;</span> + info + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                item6-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;code:&quot;</span> + code));</span><br><span class="line">                item6-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Checksum:&quot;</span> + checksum));</span><br><span class="line">                item6-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;type:&quot;</span> + type + <span class="string">&quot;(&quot;</span> + info + <span class="string">&quot;)&quot;</span>));</span><br><span class="line">                item6-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Identifier:&quot;</span> + id));</span><br><span class="line">                item6-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Sequence Number:&quot;</span> + seq));</span><br><span class="line">                <span class="keyword">if</span>(dataLengthofIp &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                    QTreeWidgetItem* dataItem = <span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Data (&quot;</span> + QString::<span class="built_in">number</span>(dataLengthofIp) + <span class="string">&quot;) bytes&quot;</span>);</span><br><span class="line">                    item6-&gt;<span class="built_in">addChild</span>(dataItem);</span><br><span class="line">                    QString icmpData = data[rowNumber].<span class="built_in">getIcmpData</span>(dataLengthofIp);</span><br><span class="line">                    dataItem-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;icmpData));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// the ethernet may have padding to ensure that the minimum length of the data packet is greater than 46</span></span><br><span class="line">        <span class="type">int</span> macDataLength = data[rowNumber].<span class="built_in">getIpTotalLength</span>().<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>();</span><br><span class="line">        <span class="type">int</span> dataPackageLength = data[rowNumber].<span class="built_in">getDataLength</span>().<span class="built_in">toUtf8</span>().<span class="built_in">toInt</span>();</span><br><span class="line">        <span class="type">int</span> delta = dataPackageLength - macDataLength;</span><br><span class="line">        <span class="keyword">if</span>(delta &gt; <span class="number">14</span>)&#123;</span><br><span class="line">            <span class="type">int</span> padding = delta - <span class="number">14</span>;</span><br><span class="line">            QString pad = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span> (pad.<span class="built_in">size</span>() &lt; padding * <span class="number">2</span>) &#123;</span><br><span class="line">                pad += <span class="string">&quot;00&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            item-&gt;<span class="built_in">addChild</span>(<span class="keyword">new</span> <span class="built_in">QTreeWidgetItem</span>(<span class="built_in">QStringList</span>()&lt;&lt;<span class="string">&quot;Padding: &quot;</span> + pad));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * on_lineEdit_returnPressed</span></span><br><span class="line"><span class="comment"> * if you press the enter key,when capture is stopped</span></span><br><span class="line"><span class="comment"> * table will Filter eligible item</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_lineEdit_returnPressed</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString text = ui-&gt;lineEdit-&gt;<span class="built_in">text</span>();</span><br><span class="line">    text = text.<span class="built_in">toUpper</span>();</span><br><span class="line">    QString target = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(text == <span class="string">&quot;&quot;</span> || text == <span class="string">&quot;UDP&quot;</span> || text == <span class="string">&quot;TCP&quot;</span> || text == <span class="string">&quot;DNS&quot;</span> || text == <span class="string">&quot;ARP&quot;</span>|| text == <span class="string">&quot;ICMP&quot;</span>|| text == <span class="string">&quot;SSL&quot;</span> || text == <span class="string">&quot;TLS&quot;</span>)&#123;</span><br><span class="line">        ui-&gt;lineEdit-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;QLineEdit &#123;background-color: rgb(154,255,154);&#125;&quot;</span>);</span><br><span class="line">        target = text;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        ui-&gt;lineEdit-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;QLineEdit &#123;background-color: rgb(250,128,114);&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> number = ui-&gt;tableWidget-&gt;<span class="built_in">rowCount</span>();</span><br><span class="line">    <span class="keyword">if</span>(!isStart &amp;&amp; target != <span class="string">&quot;#&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(target!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; number;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ui-&gt;tableWidget-&gt;<span class="built_in">item</span>(i,<span class="number">4</span>)-&gt;<span class="built_in">text</span>() != target)&#123;</span><br><span class="line">                    ui-&gt;tableWidget-&gt;<span class="built_in">setRowHidden</span>(i,<span class="literal">true</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    ui-&gt;tableWidget-&gt;<span class="built_in">setRowHidden</span>(i,<span class="literal">false</span>);</span><br><span class="line">                    count++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> number = ui-&gt;tableWidget-&gt;<span class="built_in">rowCount</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; number;i++)&#123;</span><br><span class="line">                ui-&gt;tableWidget-&gt;<span class="built_in">setRowHidden</span>(i,<span class="literal">false</span>);</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(number != <span class="number">0</span>)</span><br><span class="line">        res = (count*<span class="number">100.0</span>)/number;</span><br><span class="line">    <span class="built_in">statusBar</span>()-&gt;<span class="built_in">showMessage</span>(<span class="string">&quot;Have show (&quot;</span> + QString::<span class="built_in">number</span>(count) + <span class="string">&quot;) &quot;</span> +QString::<span class="built_in">number</span>(res,<span class="number">10</span>,<span class="number">2</span>) + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * on_lineEdit_textChanged</span></span><br><span class="line"><span class="comment"> * when text at lineEdit changed,it will check input information is correct or not</span></span><br><span class="line"><span class="comment"> * if it is corrected,the color is green or it will be red</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_lineEdit_textChanged</span><span class="params">(<span class="type">const</span> QString &amp;arg1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    QString text = arg1;</span><br><span class="line">    text = text.<span class="built_in">toLower</span>();</span><br><span class="line">    <span class="keyword">if</span>(text == <span class="string">&quot;&quot;</span> || text == <span class="string">&quot;udp&quot;</span> || text == <span class="string">&quot;tcp&quot;</span> || text == <span class="string">&quot;dns&quot;</span> || text == <span class="string">&quot;arp&quot;</span> || text == <span class="string">&quot;icmp&quot;</span> || text == <span class="string">&quot;tls&quot;</span> || text == <span class="string">&quot;ssl&quot;</span>)&#123;</span><br><span class="line">        ui-&gt;lineEdit-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;QLineEdit &#123;background-color: rgb(154,255,154);&#125;&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        ui-&gt;lineEdit-&gt;<span class="built_in">setStyleSheet</span>(<span class="string">&quot;QLineEdit &#123;background-color: rgb(250,128,114);&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * on_tableWidget_currentCellChanged</span></span><br><span class="line"><span class="comment"> * this fucntion can response to up-down key</span></span><br><span class="line"><span class="comment"> * when you use the keyboard to manipulate,this bottom treewidget will also show information as well as you use mouse</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MainWindow::on_tableWidget_currentCellChanged</span><span class="params">(<span class="type">int</span> currentRow, <span class="type">int</span> currentColumn, <span class="type">int</span> previousRow, <span class="type">int</span> previousColumn)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((currentRow != previousRow) &amp;&amp; previousRow &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">on_tableWidget_cellClicked</span>(currentRow,currentColumn);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>9、readonlydelegate.h</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> READONLYDELEGATE_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> READONLYDELEGATE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QItemDelegate&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QStyleOptionViewItem&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ReadOnlyDelegate</span>: <span class="keyword">public</span> QItemDelegate</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ReadOnlyDelegate</span>(QWidget *parent = <span class="literal">nullptr</span>):<span class="built_in">QItemDelegate</span>(parent)</span><br><span class="line">    &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">QWidget *<span class="title">createEditor</span><span class="params">(QWidget *parent, <span class="type">const</span> QStyleOptionViewItem &amp;option,</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="type">const</span> QModelIndex &amp;index)</span> <span class="type">const</span> <span class="keyword">override</span> <span class="comment">//final</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">Q_UNUSED</span>(parent)</span><br><span class="line">        <span class="built_in">Q_UNUSED</span>(option)</span><br><span class="line">        <span class="built_in">Q_UNUSED</span>(index)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// READONLYDELEGATE_H</span></span></span><br></pre></td></tr></table></figure>

<p>10、main.cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mainwindow.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      * pls modify the shark.pro:</span></span><br><span class="line"><span class="comment">      * INCLUDEPATH += yourpath/Include</span></span><br><span class="line"><span class="comment">      * LIBS += your path/Lib/wpcap.lib  libws2_32</span></span><br><span class="line"><span class="comment">      * or IDE will warn you can&#x27;t find some headerfiles!</span></span><br><span class="line"><span class="comment">      * this step helps us to add winpcap to our project actually</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    MainWindow w;</span><br><span class="line">    w.<span class="built_in">setWindowTitle</span>(<span class="string">&quot;Shark - @copyright by 卡布诺奇&quot;</span>);</span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Cappuccino</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://centlabs.github.io/2022/08/09/Qt%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%87%AA%E5%88%B6Wireshark/">https://centlabs.github.io/2022/08/09/Qt%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%87%AA%E5%88%B6Wireshark/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/QT/">QT</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/03/11/CTF%E7%AB%9E%E8%B5%9B%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%88%B7%E9%A2%98%E7%BD%91%E5%9D%80/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">CTF竞赛介绍以及刷题网址</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/04/Office%E4%B8%8B%E8%BD%BD%E5%90%88%E9%9B%86/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Office下载合集</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/05/06/Qmake%20VS%20Cmake/" title="Qmake VS Cmake"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-06</div><div class="title">Qmake VS Cmake</div></div></a></div><div><a href="/2022/08/03/Qt%E9%A1%B9%E7%9B%AEdemo%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%9C%A8ui%E7%95%8C%E9%9D%A2%E4%B8%8A%E6%98%BE%E7%A4%BA/" title="Qt项目demo：数据在ui界面上显示"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-03</div><div class="title">Qt项目demo：数据在ui界面上显示</div></div></a></div><div><a href="/2022/05/06/Qt%EF%BC%9AMinGW%20%E4%B8%8EMSVC%E7%9A%84%E5%8C%BA%E5%88%AB/" title="Qt： MinGW 与 MSVC的区别"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-06</div><div class="title">Qt： MinGW 与 MSVC的区别</div></div></a></div><div><a href="/2022/03/30/Qt%205%20%E5%BC%80%E5%8F%91%E5%8F%8A%E5%AE%9E%E4%BE%8B/" title="Qt 5 模板库、工具类及控件"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-30</div><div class="title">Qt 5 模板库、工具类及控件</div></div></a></div><div><a href="/2022/05/06/%E5%90%84%E7%A7%8D%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7%E5%90%8D%E8%AF%8D%E7%9A%84%E8%A7%A3%E9%87%8A/" title="捋一捋gcc/g++/MingW/MSVC与make/CMake的关系"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-06</div><div class="title">捋一捋gcc/g++/MingW/MSVC与make/CMake的关系</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cappuccino</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">31</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">14</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">项目源码</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/12/Data%20Structure-%E7%8E%8B%E9%81%93/" title="Data Structure - 王道"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Data Structure - 王道"/></a><div class="content"><a class="title" href="/2023/11/12/Data%20Structure-%E7%8E%8B%E9%81%93/" title="Data Structure - 王道">Data Structure - 王道</a><time datetime="2023-11-12T15:05:01.134Z" title="Created 2023-11-12 23:05:01">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/12/Data%20Structure%20Algorithm/" title="Data Structure Algorithm"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Data Structure Algorithm"/></a><div class="content"><a class="title" href="/2023/11/12/Data%20Structure%20Algorithm/" title="Data Structure Algorithm">Data Structure Algorithm</a><time datetime="2023-11-12T13:02:28.408Z" title="Created 2023-11-12 21:02:28">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/12/Data%20Structure/" title="Data Structure"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Data Structure"/></a><div class="content"><a class="title" href="/2023/11/12/Data%20Structure/" title="Data Structure">Data Structure</a><time datetime="2023-11-12T09:47:27.180Z" title="Created 2023-11-12 17:47:27">2023-11-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/11/CTF%E7%AB%9E%E8%B5%9B%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%88%B7%E9%A2%98%E7%BD%91%E5%9D%80/" title="CTF竞赛介绍以及刷题网址"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CTF竞赛介绍以及刷题网址"/></a><div class="content"><a class="title" href="/2023/03/11/CTF%E7%AB%9E%E8%B5%9B%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E5%88%B7%E9%A2%98%E7%BD%91%E5%9D%80/" title="CTF竞赛介绍以及刷题网址">CTF竞赛介绍以及刷题网址</a><time datetime="2023-03-11T03:46:03.959Z" title="Created 2023-03-11 11:46:03">2023-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/09/Qt%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%87%AA%E5%88%B6Wireshark/" title="Qt项目：自制Wireshark"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Qt项目：自制Wireshark"/></a><div class="content"><a class="title" href="/2022/08/09/Qt%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%87%AA%E5%88%B6Wireshark/" title="Qt项目：自制Wireshark">Qt项目：自制Wireshark</a><time datetime="2022-08-09T15:22:32.533Z" title="Created 2022-08-09 23:22:32">2022-08-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Cappuccino</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>